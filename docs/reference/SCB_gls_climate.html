<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Construct Simultaneous Confidence Bands for a Spatial Generalized Least Square Model — SCB_gls_climate • SCoRES Package</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Construct Simultaneous Confidence Bands for a Spatial Generalized Least Square Model — SCB_gls_climate"><meta name="description" content="Construct Simultaneous Confidence Bands for a Spatial Generalized Least Square Model"><meta property="og:description" content="Construct Simultaneous Confidence Bands for a Spatial Generalized Least Square Model"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SCoRES Package</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/SCoRES.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/Functional_Data_Example.html">Functional Data Example</a></li>
    <li><a class="dropdown-item" href="../articles/Geographic_Data_Example.html">Geographic Data Example</a></li>
    <li><a class="dropdown-item" href="../articles/Linear_Model_Example.html">Linear Model Example</a></li>
    <li><a class="dropdown-item" href="../articles/Methods.html">Methods</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AngelaYuStat/SCoRES/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Construct Simultaneous Confidence Bands for a Spatial Generalized Least Square Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/AngelaYuStat/SCoRES/blob/HEAD/R/climate_functions.R" class="external-link"><code>R/climate_functions.R</code></a></small>
      <div class="d-none name"><code>SCB_gls_climate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Construct Simultaneous Confidence Bands for a Spatial Generalized Least Square Model</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SCB_gls_climate</span><span class="op">(</span></span>
<span>  <span class="va">sp_list</span>,</span>
<span>  level <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data_fit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  w <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  correlation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  corpar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  V <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  N <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  mask <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sp-list">sp_list<a class="anchor" aria-label="anchor" href="#arg-sp-list"></a></dt>
<dd><p>A list containing the spatial coordinates and the observations.
Should include the following components:</p><ul><li><p><code>x</code>: A numeric vector of x-coordinates (e.g., longitude).</p></li>
<li><p><code>y</code>: A numeric vector of y-coordinates (e.g., latitude).</p></li>
<li><p><code>obs</code>: A 3D array of observations with dimensions
<code>length(x)</code> × <code>length(y)</code> × <code>n</code>.</p></li>
</ul></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>A optional numeric threshold value used to test whether the
estimated mean surface significantly deviates from it. Default is NULL.</p></dd>


<dt id="arg-data-fit">data_fit<a class="anchor" aria-label="anchor" href="#arg-data-fit"></a></dt>
<dd><p>A design matrix used to fit the generalized least squares
(GLS) model. Each row corresponds to an observation, and each column to a covariate
to be included in the model. Outcome/observation should not be included.
The first column is typically an intercept column,
which will contain only 1s, if an intercept is included in the model.
Categorical variables in <code>data_fit</code> should be converted to dummy variables.
Default is <code>matrix(1, n, 1)</code> (only keep the intercept term)</p></dd>


<dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>A numeric vector specifying the target function for constructing the SCB,
by giving a linear combination of the regression coefficients in the GLS model.
Default is <code>matrix(1, 1, 1)</code>, will only construct the SCB for the first regression
coefficient.</p></dd>


<dt id="arg-correlation">correlation<a class="anchor" aria-label="anchor" href="#arg-correlation"></a></dt>
<dd><p>A character string specifying the name of
the correlation structure (e.g., <code>"corAR1"</code>, <code>"corCompSymm"</code>)
to be used in the GLS model. If <code>NULL</code>, no correlation structure is assumed.</p></dd>


<dt id="arg-corpar">corpar<a class="anchor" aria-label="anchor" href="#arg-corpar"></a></dt>
<dd><p>A numerical vector containing parameters to be passed to
the correlation structure function specified in <code>correlation</code>.</p></dd>


<dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>A vector of group identifiers used to define
the within-group correlation structure (e.g., repeated measures, time blocks).
If not specified, defaults to <code>rep(1, n)</code>, assuming all observations
belong to a single group.</p></dd>


<dt id="arg-v">V<a class="anchor" aria-label="anchor" href="#arg-v"></a></dt>
<dd><p>An optional array of known covariance matrices of
shape <code>[length(x), length(y), n, n]</code>, where each <code>V[i,j,,]</code>
corresponds to the covariance matrix for the observations at spatial location
<code>(x[i], y[j])</code>. If V is given, then the GLS model will be fitted based on V.
Otherwise, the GLS model will be fitted based on correlation structure.
If neither is provided, the model reduces to ordinary least squares (OLS) regression.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>A numerical value specifying the confidence level
for the Simultaneous Confidence Bands. Defalut is <code>0.1</code>.</p></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>An integer specifying the number of bootstrap samples to
construct the Simultaneous Confidence Bands. Default is <code>1000</code>.</p></dd>


<dt id="arg-mask">mask<a class="anchor" aria-label="anchor" href="#arg-mask"></a></dt>
<dd><p>An optional logical matrix same dimensions as
<code>c(length(sp_list$x), length(sp_list$y))</code>, indicating spatial locations to
include in the SCB computation. Non-included locations (e.g., water areas)
should be set to 0 or <code>NA</code>.
Default is <code>array(1, dim = c(length(sp_list$x), length(sp_list$y)))</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the following components:</p><dl><dt><code>scb_up</code></dt>
<dd><p>A matrix of upper bounds for
the simultaneous confidence bands at each spatial location
corresponding to the target function specified by <code>w</code>.</p></dd>

<dt><code>scb_low</code></dt>
<dd><p>A matrix of lower bounds for
the simultaneous confidence bands at each spatial location
corresponding to the target function specified by <code>w</code>.</p></dd>

<dt><code>mu_hat</code></dt>
<dd><p>A matrix of estimated mean values at each spatial location
corresponding to the target function specified by <code>w</code>.</p></dd>

<dt><code>norm_est</code></dt>
<dd><p>A matrix of standardized test statistics <code>(mu_hat - level) / SE</code>.</p></dd>

<dt><code>thres</code></dt>
<dd><p>The bootstrap threshold used to construct the confidence bands.</p></dd>

<dt><code>x</code></dt>
<dd><p>The vector of x-coordinates corresponding to the columns of the spatial grid.</p></dd>

<dt><code>y</code></dt>
<dd><p>The vector of y-coordinates corresponding to the rows of the spatial grid.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Sommerfeld, M., Sain, S., &amp; Schwartzman, A. (2018).
Confidence regions for spatial excursion sets from repeated random field observations, with an application to climate.
<em>Journal of the American Statistical Association</em>, 113(523), 1327–1340.
<a href="https://doi.org/10.1080/01621459.2017.1356318" class="external-link">doi:10.1080/01621459.2017.1356318</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">climate_data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">nlme</a></span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>package ‘nlme’ was built under R version 4.4.3</span>
<span class="r-in"><span><span class="co"># Construct confidence sets for the increase of the mean temperature (June-August)</span></span></span>
<span class="r-in"><span><span class="co"># in North America between the 20th and 21st centuries</span></span></span>
<span class="r-in"><span><span class="va">temp</span> <span class="op">=</span> <span class="fu">SCB_gls_climate</span><span class="op">(</span>sp_list <span class="op">=</span> <span class="va">climate_data</span><span class="op">$</span><span class="va">Z</span>, level <span class="op">=</span> <span class="fl">2</span>, data_fit <span class="op">=</span> <span class="va">climate_data</span><span class="op">$</span><span class="va">X</span>,</span></span>
<span class="r-in"><span>                       w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, correlation <span class="op">=</span> <span class="va">climate_data</span><span class="op">$</span><span class="va">correlation</span>,</span></span>
<span class="r-in"><span>                       mask <span class="op">=</span> <span class="va">climate_data</span><span class="op">$</span><span class="va">mask</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhuoran Yu, Armin Schwartzman, Junting Ren, Julia Wrobel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

