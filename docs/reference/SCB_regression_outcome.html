<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simultaneous Confidence Bands for Regression Outcomes or Coefficients — SCB_regression_outcome • SCoRES Package</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simultaneous Confidence Bands for Regression Outcomes or Coefficients — SCB_regression_outcome"><meta name="description" content="This function fits a user-specified regression model (linear or logistic),
and constructs simultaneous confidence bands (SCBs) for either the mean outcome
or the regression coefficients. SCBs are obtained using a nonparametric bootstrap
procedure evaluated on a fixed test design matrix, providing simultaneous
inference across the entire range of covariates or parameters of interest."><meta property="og:description" content="This function fits a user-specified regression model (linear or logistic),
and constructs simultaneous confidence bands (SCBs) for either the mean outcome
or the regression coefficients. SCBs are obtained using a nonparametric bootstrap
procedure evaluated on a fixed test design matrix, providing simultaneous
inference across the entire range of covariates or parameters of interest."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SCoRES Package</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/SCoRES.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/Functional_Data_Example.html">Functional Data Example</a></li>
    <li><a class="dropdown-item" href="../articles/Geographic_Data_Example.html">Geographic Data Example</a></li>
    <li><a class="dropdown-item" href="../articles/Linear_Model_Example.html">Linear Model Example</a></li>
    <li><a class="dropdown-item" href="../articles/Methods.html">Methods</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AngelaYuStat/SCoRES/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simultaneous Confidence Bands for Regression Outcomes or Coefficients</h1>
      <small class="dont-index">Source: <a href="https://github.com/AngelaYuStat/SCoRES/blob/HEAD/R/regression_outcome_scb.R" class="external-link"><code>R/regression_outcome_scb.R</code></a></small>
      <div class="d-none name"><code>SCB_regression_outcome.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function fits a user-specified regression model (linear or logistic),
and constructs simultaneous confidence bands (SCBs) for either the mean outcome
or the regression coefficients. SCBs are obtained using a nonparametric bootstrap
procedure evaluated on a fixed test design matrix, providing simultaneous
inference across the entire range of covariates or parameters of interest.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SCB_regression_outcome</span><span class="op">(</span></span>
<span>  <span class="va">df_fit</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  grid_df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_boot <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  grid_df_boot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  w <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df-fit">df_fit<a class="anchor" aria-label="anchor" href="#arg-df-fit"></a></dt>
<dd><p>A data frame containing the training design matrix used
to fit the linear model. Acceptable input format includes numeric and factor.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A character string representing the formula for the linear model
(e.g., <code>"y ~ x1 + x2"</code>).</p></dd>


<dt id="arg-grid-df">grid_df<a class="anchor" aria-label="anchor" href="#arg-grid-df"></a></dt>
<dd><p>A data frame specifying the covariate settings that define the
mean outcome or linear combination for which simultaneous confidence bands (SCB)
are constructed.
Each row represents one covariate combination at which predictions and
SCBs are evaluated. Column names should match variables in the fitted model,
but <code>grid_df</code> may include only the subset of covariates of interest for the SCB
(it is not required to cover all model variables).
Default is <code>NULL</code>, in which case the SCB is constructed over the fitted values
based on 'df_fit`.</p></dd>


<dt id="arg-n-boot">n_boot<a class="anchor" aria-label="anchor" href="#arg-n-boot"></a></dt>
<dd><p>Number of bootstrap samples used in the non-parametric bootstrap
procedure to generate the empirical distribution. Default is 1000.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Significance level for the confidence band
(e.g., 0.05 for 95% confidence). Default is 0.05.</p></dd>


<dt id="arg-grid-df-boot">grid_df_boot<a class="anchor" aria-label="anchor" href="#arg-grid-df-boot"></a></dt>
<dd><p>An optional data frame specifying the input grid at which
predictions are evaluated during bootstrap resampling.
This allows SCBs to be constructed on a denser set of covariate values
if desired. If NULL, uses <code>grid_df</code>.
If <code>grid_df</code> is set to NULL, <code>grid_df_boot</code> will also be set to <code>NULL</code>.
This argument is only for <code>type</code> = <code>linear</code>.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A character string specifying the model type. Either <code>"linear"</code>
(default) or <code>"logistic"</code>.</p></dd>


<dt id="arg-fitted">fitted<a class="anchor" aria-label="anchor" href="#arg-fitted"></a></dt>
<dd><p>Logical. Whether to estimate the simultaneous confidence bands
for regression outcomes or coefficients.</p><ul><li><p><code>TRUE</code> - Estimate the simultaneous confidence bands
for regression outcomes.</p></li>
<li><p><code>FALSE</code> - estimate the simultaneous confidence bands
for regression coefficients.</p></li>
</ul><p>Default is <code>TRUE</code>.</p></dd>


<dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>A numeric matrix that specifies the linear combinations of regression coefficients
for which simultaneous confidence bands (SCBs) are to be constructed.
The number of columns should be equal to the number of coefficients in the
regression model fitted.
Default is NULL, will return SCBs for all coefficients and the intercept.
This argument is only for <code>fitted</code> = <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with the following columns:</p><dl><dt>scb_low</dt>
<dd><p>Lower bound of the simultaneous confidence band.</p></dd>

<dt>Mean</dt>
<dd><p>Predicted mean response from the fitted model.</p></dd>

<dt>scb_up</dt>
<dd><p>Upper bound of the simultaneous confidence band.</p></dd>

<dt>...</dt>
<dd><p>All columns from <code>grid_df</code>, representing the prediction grid.
Optional, if <code>fitted</code> = <code>TRUE</code></p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">262</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x1</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x1</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">1.1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">^</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x2</span> <span class="op">+</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="va">x2</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">1.1</span> <span class="op">*</span> <span class="va">x2</span><span class="op">^</span><span class="fl">3</span> <span class="op">+</span> <span class="va">epsilon</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">"y ~ x1 + I(x1^2) + I(x1^3) + x2 + I(x2^2) + I(x2^3)"</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">SCB_regression_outcome</span><span class="op">(</span>df_fit <span class="op">=</span> <span class="va">df</span>, model <span class="op">=</span> <span class="va">model</span>, grid_df <span class="op">=</span> <span class="va">grid</span>, w   <span class="op">=</span> <span class="va">w</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhuoran Yu, Armin Schwartzman, Junting Ren, Julia Wrobel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

