<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Construct Simultaneous Confidence Bands (SCB) For One Dimensional Functional Data Using Specified Methods — SCB_functional_outcome • SCoRES</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Construct Simultaneous Confidence Bands (SCB) For One Dimensional Functional Data Using Specified Methods — SCB_functional_outcome"><meta property="og:description" content="This function builds simultaneous confidence bands through two distinct approaches.."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SCoRES</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/SCoRES.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Functional_Data_Example.html">Functional_Data_Example</a>
    </li>
    <li>
      <a href="../articles/Geographic_Data_Examples.html">Geographic_Data_Examples</a>
    </li>
    <li>
      <a href="../articles/Linear_Model_Example.html">Linear_Model_Example</a>
    </li>
    <li>
      <a href="../articles/Methods.html">Methods</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Construct Simultaneous Confidence Bands (SCB) For One Dimensional Functional Data Using Specified Methods</h1>

    <div class="hidden name"><code>SCB_functional_outcome.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function builds simultaneous confidence bands through two distinct approaches..</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SCB_functional_outcome</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  object <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">method</span>,</span>
<span>  fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  est_mean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">subject</span>,</span>
<span>  nboot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method_SD <span class="op">=</span> <span class="st">"t"</span>,</span>
<span>  weights <span class="op">=</span> <span class="st">"rademacher"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A functional data frame, matrix or tibble.
The input data must have column names, and should contain the functional outcome, time, subject</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A fitted Function-on-Scalar Regression (FoSR) object (e.g., from mgcv::bam()/mgcv::gam()). Default is <code>NULL</code></p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A character string specifying the approach:</p><ul><li><p><code>"cma"</code> - Correlation and Multiplicity Adjusted (CMA) confidence bands
via parametric approach (requires a fitted functional regression model)</p></li>
<li><p><code>"multiplier"</code> - Dense confidence bands via Multiplier-t Bootstrap method
For <code>method = "multiplier"</code> option, the user should check whether their input data (<code>data</code>) has zero entries on every subject for a specific time point.
The function only allow all zero entries for time point zero. Otherwise, the function will return an error.
Besides, for Multiplier Bootstrap, if there exist NA in data, the function will impute these NA's via fpca.face.</p></li>
</ul></dd>


<dt id="arg-fitted">fitted<a class="anchor" aria-label="anchor" href="#arg-fitted"></a></dt>
<dd><p>Logical. Whether to estimate the simultaneous confidence bands for fitted mean function or fitted parameter function</p><ul><li><p><code>TRUE</code> - Estimate the simultaneous confidence bands for fitted mean outcome function.</p></li>
<li><p><code>FALSE</code> - estimate the simultaneous confidence bands for fitted parameter function.</p></li>
</ul><p>Default is <code>TRUE</code>.</p></dd>


<dt id="arg-est-mean">est_mean<a class="anchor" aria-label="anchor" href="#arg-est-mean"></a></dt>
<dd><p>Logical. Whether to use the fitted mean from a functional regression model in Multiplier Bootstrap (<code>method = "multiplier"</code>) for estimating the quantile.
This argument can be ignored if choose <code>method = "cma"</code>.
If <code>TRUE</code>, the function will use:</p><ul><li><p><strong>Fitted mean:</strong> The estimated mean function from a fitted model (e.g., <code><a href="https://rdrr.io/pkg/mgcv/man/bam.html" class="external-link">mgcv::bam</a></code>).
Need to provide a fitted functional outcome regression model object. Otherwise, the sample mean will be calculated.</p></li>
</ul><p>If <code>FALSE</code>, the function will instead use:</p><ul><li><p><strong>Sample mean:</strong>
$$\hat{\beta}(s) = \frac{1}{n} \sum_{i=1}^n \tilde{Y}_i(s)$$
where \(\tilde{Y}_i(s)\) is a smoothed version of the observed functional response.
For this sample mean option, if there exists NA in <code>data</code>, will perform imputation to fill in those values.</p></li>
</ul><p>Default is <code>FALSE</code>.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Significance level for SCB. Default is 0.05.</p></dd>


<dt id="arg-outcome">outcome<a class="anchor" aria-label="anchor" href="#arg-outcome"></a></dt>
<dd><p>A character string specifying the name of the outcome variable used in the model. Must be provided if choose <code>method = "multiplier"</code>.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>A character string specifying the name of the time variable used in the model.</p></dd>


<dt id="arg-range">range<a class="anchor" aria-label="anchor" href="#arg-range"></a></dt>
<dd><p>A numeric vector specifying the range or grid of time points interested. Defaut is the whole time points from the fitted model.</p></dd>


<dt id="arg-group-name">group_name<a class="anchor" aria-label="anchor" href="#arg-group-name"></a></dt>
<dd><p>A character vector that specifies the names of grouping scalar variables to analyze.
Default is <code>NULL</code>, representing the reference group if <code>method = "cma"</code>.
For <code>method = "multiplier"</code>, <code>NuULL</code> is not allowed.</p></dd>


<dt id="arg-group-value">group_value<a class="anchor" aria-label="anchor" href="#arg-group-value"></a></dt>
<dd><p>A numeric vector that specifies the corresponding values of the variables listed in <code>group_name</code>.
Each entry in <code>group_value</code> should match the respective variable in <code>group_name</code>.
Character/factor is not allowed.
Default is <code>NULL</code>, representing the reference group if <code>"cma"</code>.
For <code>method = "multiplier"</code>, <code>NuULL</code> is not allowed.</p></dd>


<dt id="arg-subject">subject<a class="anchor" aria-label="anchor" href="#arg-subject"></a></dt>
<dd><p>A character string specifying the name of the subject-level random effect variable.</p></dd>


<dt id="arg-nboot">nboot<a class="anchor" aria-label="anchor" href="#arg-nboot"></a></dt>
<dd><p>An integer specifying the number of bootstrap samples used to construct the confidence bands. Default is 10,000 for cma, 5000 for Multiplier Bootstrap.</p></dd>


<dt id="arg-method-sd">method_SD<a class="anchor" aria-label="anchor" href="#arg-method-sd"></a></dt>
<dd><p>Method for SD estimation: "t" or "regular". Default is "t".</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Multiplier type: "rademacher", "gaussian", or "mammen". Default is "rademacher"."</p>
<p>For CMA bands (<code>method = "cma"</code>), please provide a pre-fitted functional regression model
For Multiplier Bootstrap bands (<code>method = "multiplier"</code>), the original input data is required.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list containing:</p>
<dl><dt>yhat</dt>
<dd><p>Estimated mean function for the group of interest.</p></dd>

<dt>time</dt>
<dd><p>The time points used.</p></dd>

<dt>se_hat</dt>
<dd><p>Standard errors of the estimated means.</p></dd>

<dt>scb_low</dt>
<dd><p>Lower bound of the simultaneous confidence band.</p></dd>

<dt>scb_up</dt>
<dd><p>Upper bound of the simultaneous confidence band.</p></dd>

<dt>type</dt>
<dd><p>A character description of the output type.</p></dd>

</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># example using ccds data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ccds</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ccds_fpca</span> <span class="op">&lt;-</span> <span class="fu"><a href="prepare_ccds_fpca.html">prepare_ccds_fpca</a></span><span class="op">(</span><span class="va">ccds</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fosr_mod</span> <span class="op">&lt;-</span> <span class="fu">mgcv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/bam.html" class="external-link">bam</a></span><span class="op">(</span><span class="va">percent_change</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">seconds</span>, k<span class="op">=</span><span class="fl">30</span>, bs<span class="op">=</span><span class="st">"cr"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">s</span><span class="op">(</span><span class="va">seconds</span>, by <span class="op">=</span> <span class="va">use</span>, k<span class="op">=</span><span class="fl">30</span>, bs <span class="op">=</span> <span class="st">"cr"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">s</span><span class="op">(</span><span class="va">subject</span>, by <span class="op">=</span> <span class="va">Phi1</span>, bs<span class="op">=</span><span class="st">"re"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">s</span><span class="op">(</span><span class="va">subject</span>, by <span class="op">=</span> <span class="va">Phi2</span>, bs<span class="op">=</span><span class="st">"re"</span><span class="op">)</span><span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">s</span><span class="op">(</span><span class="va">subject</span>, by <span class="op">=</span> <span class="va">Phi3</span>, bs<span class="op">=</span><span class="st">"re"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">s</span><span class="op">(</span><span class="va">subject</span>, by <span class="op">=</span> <span class="va">Phi4</span>, bs<span class="op">=</span><span class="st">"re"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"fREML"</span>, data <span class="op">=</span> <span class="va">ccds_fpca</span>, discrete <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># CMA approach</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">SCB_functional_outcome</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ccds</span>, object <span class="op">=</span> <span class="va">fosr_mod</span>, method <span class="op">=</span> <span class="st">"cma"</span>, fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                  est_mean <span class="op">=</span> <span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="st">"percent_change"</span>, time <span class="op">=</span> <span class="st">"seconds"</span>,</span></span>
<span class="r-in"><span>                                  group_name <span class="op">=</span> <span class="st">"use"</span>, group_value <span class="op">=</span> <span class="fl">1</span>, subject <span class="op">=</span> <span class="st">"subject"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># multiplier bootstrap</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">SCB_functional_outcome</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ccds</span>, object <span class="op">=</span> <span class="va">fosr_mod</span>, method <span class="op">=</span> <span class="st">"multiplier"</span>, fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                       est_mean <span class="op">=</span> <span class="cn">TRUE</span>, outcome <span class="op">=</span> <span class="st">"percent_change"</span>,</span></span>
<span class="r-in"><span>                       time <span class="op">=</span> <span class="st">"seconds"</span>, group_name <span class="op">=</span> <span class="st">"use"</span>, group_value <span class="op">=</span> <span class="fl">1</span>, subject <span class="op">=</span> <span class="st">"subject"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">SCB_functional_outcome</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ccds</span>, object <span class="op">=</span> <span class="va">fosr_mod</span>, method <span class="op">=</span> <span class="st">"multiplier"</span>, fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                       est_mean <span class="op">=</span> <span class="cn">FALSE</span>, outcome <span class="op">=</span> <span class="st">"percent_change"</span>,</span></span>
<span class="r-in"><span>                       time <span class="op">=</span> <span class="st">"seconds"</span>, group_name <span class="op">=</span> <span class="st">"use"</span>, group_value <span class="op">=</span> <span class="fl">1</span>, subject <span class="op">=</span> <span class="st">"subject"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

