<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Construct Simultaneous Confidence Bands (SCB) For One Dimensional Functional Data — SCB_functional_outcome • SCoRES Package</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Construct Simultaneous Confidence Bands (SCB) For One Dimensional Functional Data — SCB_functional_outcome"><meta name="description" content="This function builds simultaneous confidence bands through parametric and
bootstrap approaches."><meta property="og:description" content="This function builds simultaneous confidence bands through parametric and
bootstrap approaches."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SCoRES Package</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/SCoRES.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/Functional_Data_Example.html">Functional Data Example</a></li>
    <li><a class="dropdown-item" href="../articles/Geographic_Data_Example.html">Geographic Data Example</a></li>
    <li><a class="dropdown-item" href="../articles/Linear_Model_Example.html">Linear Model Example</a></li>
    <li><a class="dropdown-item" href="../articles/Methods.html">Methods</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AngelaYuStat/SCoRES/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Construct Simultaneous Confidence Bands (SCB) For One Dimensional Functional Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/AngelaYuStat/SCoRES/blob/HEAD/R/SCB_functional_outcome.R" class="external-link"><code>R/SCB_functional_outcome.R</code></a></small>
      <div class="d-none name"><code>SCB_functional_outcome.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function builds simultaneous confidence bands through parametric and
bootstrap approaches.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SCB_functional_outcome</span><span class="op">(</span></span>
<span>  <span class="va">data_df</span>,</span>
<span>  object <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">method</span>,</span>
<span>  fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  <span class="va">domain</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">id</span>,</span>
<span>  nboot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method_SD <span class="op">=</span> <span class="st">"t"</span>,</span>
<span>  weights <span class="op">=</span> <span class="st">"rademacher"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-df">data_df<a class="anchor" aria-label="anchor" href="#arg-data-df"></a></dt>
<dd><p>A functional data frame that contains both name and values for
variables including functional outcome, domain (e.g. time) and ID (e.g. subject names)
used to fit the model <code>object</code>.</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A fitted Function-on-Scalar Regression (FoSR) object
(e.g., from mgcv::gam()/mgcv::bam()). Default is <code>NULL</code></p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A character string specifying the approach:</p><ul><li><p><code>"cma"</code> - Correlation and Multiplicity Adjusted (CMA) confidence bands
via parametric approach (requires a fitted functional regression model)</p></li>
<li><p><code>"multiplier"</code> - Dense confidence bands via Multiplier-t Bootstrap method
For <code>method = "multiplier"</code>, the outcome variable in <code>data_df</code>
should not have all-zero entries within any specified domain
(except for domain index zero, where this is allowed).
Otherwise, the function will return an error.
If missing values (NA) exist in the outcome variable in <code>data_df</code>,
the function will impute them using <code>fpca.face</code> before
performing the Multiplier Bootstrap.</p></li>
</ul></dd>


<dt id="arg-fitted">fitted<a class="anchor" aria-label="anchor" href="#arg-fitted"></a></dt>
<dd><p>Logical. Whether to estimate the simultaneous confidence bands
for the fitted mean function or the fitted parameter function</p><ul><li><p><code>TRUE</code> - Estimate the simultaneous confidence bands
for the fitted mean outcome function.</p></li>
<li><p><code>FALSE</code> - estimate the simultaneous confidence bands
for the fitted parameter function.</p></li>
</ul><p>Default is <code>TRUE</code>.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Significance level for SCB. Default is 0.05.</p></dd>


<dt id="arg-outcome">outcome<a class="anchor" aria-label="anchor" href="#arg-outcome"></a></dt>
<dd><p>A character string specifying the name of the outcome variable
used in the model.</p></dd>


<dt id="arg-domain">domain<a class="anchor" aria-label="anchor" href="#arg-domain"></a></dt>
<dd><p>A character string specifying the name of the domain variable
(e.g. time) used in the model.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>An atomic character vector (e.g., c("user = 1", "age = 30"))
specifying the target function for constructing the SCB.
Each element must be of the form <code>&lt;name&gt; = &lt;value&gt;</code>, where <code>&lt;name&gt;</code> is
the name of a scalar grouping variable and <code>&lt;value&gt;</code> is the desired value.
Whitespace is ignored. Binary or categorical character variables should be
transformed into numeric. Factors are not allowed here because if the input
data contains factor variables, they will be automatically expanded into
dummy (indicator) variables when constructing the design matrix, and
the resulting variable names may differ from the original factor names.
Default is <code>NULL</code>, representing the reference group.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>A character string specifying the name of the ID variable.</p></dd>


<dt id="arg-nboot">nboot<a class="anchor" aria-label="anchor" href="#arg-nboot"></a></dt>
<dd><p>An integer specifying the number of bootstrap samples used to
construct the confidence bands. Default is 10,000 for cma, 5000 for Multiplier Bootstrap.</p></dd>


<dt id="arg-method-sd">method_SD<a class="anchor" aria-label="anchor" href="#arg-method-sd"></a></dt>
<dd><p>Method for SD estimation: "t" or "regular". Default is "t".</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Multiplier type: "rademacher", "gaussian", or "mammen".
Default is "rademacher".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p><dl><dt>mu_hat</dt>
<dd><p>Estimated mean function for the group of interest.</p></dd>

<dt>domain</dt>
<dd><p>The domain used.</p></dd>

<dt>se_hat</dt>
<dd><p>Standard errors of the estimated means.</p></dd>

<dt>scb_low</dt>
<dd><p>Lower bound of the simultaneous confidence band.</p></dd>

<dt>scb_up</dt>
<dd><p>Upper bound of the simultaneous confidence band.</p></dd>

<dt>type</dt>
<dd><p>A character description of the output type.</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># example using pupil data</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pupil</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">pupil_fpca</span> <span class="op">&lt;-</span> <span class="fu"><a href="prepare_pupil_fpca.html">prepare_pupil_fpca</a></span><span class="op">(</span><span class="va">pupil</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fosr_mod</span> <span class="op">&lt;-</span> <span class="fu">mgcv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/bam.html" class="external-link">bam</a></span><span class="op">(</span><span class="va">percent_change</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">seconds</span>, k<span class="op">=</span><span class="fl">30</span>, bs<span class="op">=</span><span class="st">"cr"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">seconds</span>, by <span class="op">=</span> <span class="va">use</span>, k<span class="op">=</span><span class="fl">30</span>, bs <span class="op">=</span> <span class="st">"cr"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">id</span>, by <span class="op">=</span> <span class="va">Phi1</span>, bs<span class="op">=</span><span class="st">"re"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">id</span>, by <span class="op">=</span> <span class="va">Phi2</span>, bs<span class="op">=</span><span class="st">"re"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"fREML"</span>, data <span class="op">=</span> <span class="va">pupil_fpca</span>, discrete <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># CMA approach</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">SCB_functional_outcome</span><span class="op">(</span>data_df <span class="op">=</span> <span class="va">pupil</span>, object <span class="op">=</span> <span class="va">fosr_mod</span>,</span></span>
<span class="r-in"><span>                                  method <span class="op">=</span> <span class="st">"cma"</span>, fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                  outcome <span class="op">=</span> <span class="st">"percent_change"</span>, domain <span class="op">=</span> <span class="st">"seconds"</span>,</span></span>
<span class="r-in"><span>                                  subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"use = 1"</span><span class="op">)</span>, id <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># multiplier bootstrap</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">SCB_functional_outcome</span><span class="op">(</span>data_df <span class="op">=</span> <span class="va">pupil</span>, object <span class="op">=</span> <span class="va">fosr_mod</span>,</span></span>
<span class="r-in"><span>                                  method <span class="op">=</span> <span class="st">"multiplier"</span>, fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                  outcome <span class="op">=</span> <span class="st">"percent_change"</span>, domain <span class="op">=</span> <span class="st">"seconds"</span>,</span></span>
<span class="r-in"><span>                                  subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"use = 1"</span><span class="op">)</span>, id <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mean_mod</span> <span class="op">&lt;-</span> <span class="fu">mgcv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span><span class="va">percent_change</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">seconds</span>, k <span class="op">=</span> <span class="fl">5</span>, bs <span class="op">=</span> <span class="st">"cr"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">seconds</span>, by <span class="op">=</span> <span class="va">use</span>, k <span class="op">=</span> <span class="fl">5</span>, bs <span class="op">=</span> <span class="st">"cr"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>data <span class="op">=</span> <span class="va">pupil</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># multiplier bootstrap</span></span></span>
<span class="r-in"><span><span class="va">pupil_multiplier</span> <span class="op">&lt;-</span> <span class="fu">SCB_functional_outcome</span><span class="op">(</span>data <span class="op">=</span> <span class="va">pupil</span>, object <span class="op">=</span> <span class="va">mean_mod</span>, method <span class="op">=</span> <span class="st">"multiplier"</span>,</span></span>
<span class="r-in"><span>                                   outcome <span class="op">=</span> <span class="st">"percent_change"</span>,</span></span>
<span class="r-in"><span>                                   domain <span class="op">=</span> <span class="st">"seconds"</span>, subset<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"use = 1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                   id <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhuoran Yu, Armin Schwartzman, Junting Ren, Julia Wrobel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

