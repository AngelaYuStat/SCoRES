<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Functional_Data_Example • SCoRES</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Functional_Data_Example">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SCoRES</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/SCoRES.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Functional_Data_Example.html">Functional_Data_Example</a>
    </li>
    <li>
      <a href="../articles/Geographic_Data_Examples.html">Geographic_Data_Examples</a>
    </li>
    <li>
      <a href="../articles/Linear_Model_Example.html">Linear_Model_Example</a>
    </li>
    <li>
      <a href="../articles/Methods.html">Methods</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Functional_Data_Example</h1>
                        <h4 data-toc-skip class="author">Angela Yu</h4>
            
            <h4 data-toc-skip class="date">2025-07-28</h4>
      

      <div class="hidden name"><code>Functional_Data_Example.Rmd</code></div>

    </div>

    
    
<p>The first example here is to use ccds functional data to construct
the inverse confidence sets (CS) from simultaneous confidence bands
(SCB) using Function-on-Scalar Regression (FoSR).</p>
<p>The ccds dataset contains repeated measures of percent change over
time for multiple subjects under two user categories (use: 1 and no use:
0). It includes both user and non-user groups, time points, and metadata
related to eye side and frame timing. cleaning process make sure that
the data only includes measurements taken from the right eye at the
post-intervention timepoint (<code>tp == "post"</code>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SCoRES</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ccds</span><span class="op">)</span></span></code></pre></div>
<p>Before calculating the SCBs, we first process ccds data by fitting a
mean GAM model, extracting residuals and performing FPCA using
<code><a href="../reference/prepare_ccds_fpca.html">SCoRES::prepare_ccds_fpca()</a></code>, the function will return an
enhanced dataset includes the FPCA-derived basis scores (Phi1, Phi2,
Phi3, Phi4) for Function-on-Scalar Regression (FoSR) analysis.</p>
<p>Following the FPCA-based data augmentation, we fit a FoSR model using
<code><a href="https://rdrr.io/pkg/mgcv/man/bam.html" class="external-link">mgcv::bam()</a></code>, which allows efficient estimation of
Generalized Additive Mixed Models (GAMMs). The model formula is designed
to capture both population-level smooth trends and subject-specific
functional variation.</p>
<p>The response here is percent_change. Time variable t is seconds. And
the covariate is use, which is a binary variable (1:use, 0:no use).</p>
<p>The function-on-scalar regression model is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>X</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>ϵ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
Y_i(t) = \beta_0(t) + \beta_1(t) X_{i1} + b_i(t) + \epsilon_i(t),
</annotation></semantics></math></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ccds_fpca</span> <span class="op">&lt;-</span> <span class="fu">SCoRES</span><span class="fu">::</span><span class="fu"><a href="../reference/prepare_ccds_fpca.html">prepare_ccds_fpca</a></span><span class="op">(</span><span class="va">ccds</span><span class="op">)</span></span>
<span><span class="va">fosr_mod</span> <span class="op">&lt;-</span> <span class="fu">mgcv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/bam.html" class="external-link">bam</a></span><span class="op">(</span><span class="va">percent_change</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">seconds</span>, k<span class="op">=</span><span class="fl">30</span>, bs<span class="op">=</span><span class="st">"cr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">s</span><span class="op">(</span><span class="va">seconds</span>, by <span class="op">=</span> <span class="va">use</span>, k<span class="op">=</span><span class="fl">30</span>, bs <span class="op">=</span> <span class="st">"cr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">s</span><span class="op">(</span><span class="va">subject</span>, by <span class="op">=</span> <span class="va">Phi1</span>, bs<span class="op">=</span><span class="st">"re"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">s</span><span class="op">(</span><span class="va">subject</span>, by <span class="op">=</span> <span class="va">Phi2</span>, bs<span class="op">=</span><span class="st">"re"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">s</span><span class="op">(</span><span class="va">subject</span>, by <span class="op">=</span> <span class="va">Phi3</span>, bs<span class="op">=</span><span class="st">"re"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">s</span><span class="op">(</span><span class="va">subject</span>, by <span class="op">=</span> <span class="va">Phi4</span>, bs<span class="op">=</span><span class="st">"re"</span><span class="op">)</span>,</span>
<span>            method <span class="op">=</span> <span class="st">"fREML"</span>, data <span class="op">=</span> <span class="va">ccds_fpca</span>, discrete <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>After obtaining the FoSR object <code>fosr_mod</code>, simultaneous
confidence bands (SCB) can be constructed though
<code><a href="../reference/SCB_functional_outcome.html">SCoRES::SCB_functional_outcome</a></code> using pre-specified methods.
The SCoRES package provides two options for calculating simultaneous
confidence bands (SCBs), specified via the method argument:
<code>cma</code>: Correlation and Multiplicity Adjusted (CMA) confidence
bands via parametric approach. <code>multiplier</code>: Dense confidence
bands via Multiplier-t Bootstrap method. Use <code>groups</code> to
specify the names of grouping variables to analyze. The input data
should have numerical binary 0/1 values for all scalar group variables.
Here, we analyze the user group by specifying
<code>groups = "use"</code>. Use <code>fitted</code> to specify the
object for SCB estimation. If <code>fitted = TRUE</code>,
<code><a href="../reference/SCB_functional_outcome.html">SCoRES::SCB_functional_outcome</a></code> will construct the SCB for
the fitted mean outcome function. If <code>fitted = FALSE</code>,
<code><a href="../reference/SCB_functional_outcome.html">SCoRES::SCB_functional_outcome</a></code> will construct the SCB for
the fitted parameter function. Use est_mean to specify the point
estimate used for constructing SCBs in SCoRES::SCB_functional_outcome.
This argument is for <code>multiplier</code> If est_mean =
<code>TRUE</code>, the multiplier bootstrap will be performed based on
the fitted mean outcome function. If est_mean = <code>FALSE</code>, the
multiplier bootstrap will be performed based on the sample mean. For
<code>multiplier</code> option, users need to provide a functional
regression object through argument object. If object =
<code>NULL</code>, the function will only output the SCB for an overall
mean outcome function regardless of the group specified.</p>
<p>Here, we estimated SCBs using both options separately for the mean
outcome Y(t) of user’s group:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\hat{f}(t) = E[Y(t) | X_{1} = 1]= \beta_0(t) + \beta_1(t),
</annotation></semantics></math> where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y_i(t)</annotation></semantics></math>
is a functional outcome (percent_change)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">X_{i1}</annotation></semantics></math>
is a scalar covariate (use)</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CMA approach</span></span>
<span><span class="va">results_ccds_cma</span> <span class="op">&lt;-</span> <span class="fu">SCoRES</span><span class="fu">::</span><span class="fu"><a href="../reference/SCB_functional_outcome.html">SCB_functional_outcome</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ccds</span>,</span>
<span>                                          object <span class="op">=</span> <span class="va">fosr_mod</span>, </span>
<span>                                          method <span class="op">=</span> <span class="st">"cma"</span>,</span>
<span>                                          fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                          est_mean <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                          alpha <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>                                          outcome <span class="op">=</span> <span class="st">"percent_change"</span>, </span>
<span>                                          time <span class="op">=</span> <span class="st">"seconds"</span>, </span>
<span>                                          group_name <span class="op">=</span> <span class="st">"use"</span>, </span>
<span>                                          group_value <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                          subject <span class="op">=</span> <span class="st">"subject"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#CMA approach for parameter function</span></span>
<span><span class="va">results_ccds_cma_para</span> <span class="op">&lt;-</span> <span class="fu">SCoRES</span><span class="fu">::</span><span class="fu"><a href="../reference/SCB_functional_outcome.html">SCB_functional_outcome</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ccds</span>,</span>
<span>                                          object <span class="op">=</span> <span class="va">fosr_mod</span>, </span>
<span>                                          method <span class="op">=</span> <span class="st">"cma"</span>,</span>
<span>                                          fitted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                          est_mean <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                          alpha <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>                                          outcome <span class="op">=</span> <span class="st">"percent_change"</span>, </span>
<span>                                          time <span class="op">=</span> <span class="st">"seconds"</span>, </span>
<span>                                          group_name <span class="op">=</span> <span class="st">"use"</span>, </span>
<span>                                          group_value <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                          subject <span class="op">=</span> <span class="st">"subject"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Multiplier-t Bootstrap</span></span>
<span><span class="va">results_ccds_multiplier</span> <span class="op">&lt;-</span> <span class="fu">SCoRES</span><span class="fu">::</span><span class="fu"><a href="../reference/SCB_functional_outcome.html">SCB_functional_outcome</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ccds</span>,</span>
<span>                                          object <span class="op">=</span> <span class="va">fosr_mod</span>, </span>
<span>                                          method <span class="op">=</span> <span class="st">"multiplier"</span>,</span>
<span>                                          fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                          est_mean <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                          alpha <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>                                          outcome <span class="op">=</span> <span class="st">"percent_change"</span>, </span>
<span>                                          time <span class="op">=</span> <span class="st">"seconds"</span>, </span>
<span>                                          group_name <span class="op">=</span> <span class="st">"use"</span>, </span>
<span>                                          group_value <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                          subject <span class="op">=</span> <span class="st">"subject"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results_ccds_multiplier_para</span> <span class="op">&lt;-</span> <span class="fu">SCoRES</span><span class="fu">::</span><span class="fu"><a href="../reference/SCB_functional_outcome.html">SCB_functional_outcome</a></span><span class="op">(</span></span>
<span>                                          data <span class="op">=</span> <span class="va">ccds</span>,</span>
<span>                                          object <span class="op">=</span> <span class="va">fosr_mod</span>, </span>
<span>                                          method <span class="op">=</span> <span class="st">"multiplier"</span>,</span>
<span>                                          fitted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                          est_mean <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                          alpha <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>                                          outcome <span class="op">=</span> <span class="st">"percent_change"</span>, </span>
<span>                                          time <span class="op">=</span> <span class="st">"seconds"</span>, </span>
<span>                                          group_name <span class="op">=</span> <span class="st">"use"</span>, </span>
<span>                                          group_value <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                          subject <span class="op">=</span> <span class="st">"subject"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Multiplier-t Bootstrap (use sample mean)</span></span>
<span><span class="va">results_ccds_multiplier_sample</span> <span class="op">&lt;-</span> <span class="fu">SCoRES</span><span class="fu">::</span><span class="fu"><a href="../reference/SCB_functional_outcome.html">SCB_functional_outcome</a></span><span class="op">(</span></span>
<span>                                          data <span class="op">=</span> <span class="va">ccds</span>, </span>
<span>                                          object <span class="op">=</span> <span class="va">fosr_mod</span>, </span>
<span>                                          method <span class="op">=</span> <span class="st">"multiplier"</span>,</span>
<span>                                          fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                          est_mean <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                          alpha <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>                                          outcome <span class="op">=</span> <span class="st">"percent_change"</span>, </span>
<span>                                          time <span class="op">=</span> <span class="st">"seconds"</span>, </span>
<span>                                          group_name <span class="op">=</span> <span class="st">"use"</span>, </span>
<span>                                          group_value <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                          subject <span class="op">=</span> <span class="st">"subject"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results_ccds_multiplier_overall</span> <span class="op">&lt;-</span> <span class="fu">SCoRES</span><span class="fu">::</span><span class="fu"><a href="../reference/SCB_functional_outcome.html">SCB_functional_outcome</a></span><span class="op">(</span></span>
<span>                                          data <span class="op">=</span> <span class="va">ccds</span>,  </span>
<span>                                          method <span class="op">=</span> <span class="st">"multiplier"</span>,</span>
<span>                                          fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                          est_mean <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                          alpha <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>                                          outcome <span class="op">=</span> <span class="st">"percent_change"</span>, </span>
<span>                                          time <span class="op">=</span> <span class="st">"seconds"</span>, </span>
<span>                                          group_name <span class="op">=</span> <span class="st">"use"</span>, </span>
<span>                                          group_value <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                          subject <span class="op">=</span> <span class="st">"subject"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "No Functional Regression Object provided, will only compute an overall SCB for the outcome regardless of the group specified."</span></span></code></pre></div>
<p>In the multiplier bootstrap procedure, <code>SCoRES</code> supports
three types of multiplier distributions, which is specified by
<code>weights</code>:</p>
<ul>
<li>
<code>"rademacher"</code>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mi>−</mi><mn>1</mn><mo>,</mo><mi>+</mi><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">g_i \in \{-1, +1\}</annotation></semantics></math>
with equal probability</li>
<li>
<code>"gaussian"</code>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub><mo>∼</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_i \sim \mathcal{N}(0, 1)</annotation></semantics></math>
</li>
<li>
<code>"mammen"</code>: A two-point distribution with mean zero and
variance one (see Mammen, 1993)</li>
</ul>
<p>Default is <code>rademacher</code>.</p>
<p>Two options are available for estimating the standard error
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>ϵ</mi><mo accent="true">̂</mo></mover><mi>N</mi><mo>*</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\epsilon}_N^*(s_j)</annotation></semantics></math>,
which is specified by <code>method_SD</code>:</p>
<ul>
<li><p>“regular” (empirical standard error based on residuals):</p></li>
<li><p>“t” (bootstrap second moment-based estimator):</p></li>
</ul>
<p>Default is <code>t</code>.</p>
<p>For mathematical details, see vignette Methods.</p>
<p>The code below visualizes the <strong>inverse confidence sets
(CSs)</strong> derived from SCB results using the
<code><a href="../reference/plot_cs.html">SCoRES::plot_cs()</a></code> function. The <code>results</code> object
is first converted to a tibble for easier manipulation.</p>
<p>The <code>levels = c(-7, -8, -9, -10)</code> argument specifies a set
of thresholds, and <code><a href="../reference/plot_cs.html">SCoRES::plot_cs()</a></code> function estimates
multiple inverse upper excursion sets corresponding to these thresholds,
and plot the estimated inverse set, the inner confidence set, and the
outer confidence set.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_ccds_cma</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results_ccds_cma</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results_ccds_cma</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>, <span class="op">-</span><span class="fl">8</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">10</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="va">results_ccds_cma</span><span class="op">$</span><span class="va">time</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results_ccds_cma</span><span class="op">$</span><span class="va">yhat</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Seconds"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"Percent_Outcome"</span>, </span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Functional_Data_Example_files/figure-html/ccds_plot_cs_cma-1.png" width="576"></p>
<p>The plot demonstrate how to use SCB to find regions of s where the
estimated mean is greater than or equal to the four levels -7, -8, -9,
-10 for ccds data. The gray shaded area is the 95% SCB, the solid black
line is the estimated mean. The red horizontal line shows the inner
confidence sets (where the lower SCB is greater than the corresponding
level) that are contained in the estimated inverse set represented by
the union of the yellow and red horizontal line (where the estimated
mean is greater than the corresponding levels); the outer confidence
sets are the union of the blue, yellow and red line (where the upper SCB
is greater than the corresponding levels) and contain both the estimated
inverse sets and the inner confidence sets.</p>
<p>The next plot shows the SCB for the coefficient funtion for the use
group.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_ccds_cma_para</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results_ccds_cma_para</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results_ccds_cma_para</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2</span>, <span class="fl">2.5</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="va">results_ccds_cma_para</span><span class="op">$</span><span class="va">time</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results_ccds_cma_para</span><span class="op">$</span><span class="va">yhat</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Seconds"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"Percent_Outcome"</span>, </span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Functional_Data_Example_files/figure-html/ccds_plot_cs_cma_para-1.png" width="576"></p>
<p>The following plots show the results of multiplier bootstrap. The
only difference between these two plots is that, the solid black line in
the first one represents the estimated mean fitted through functional
regresson object, while the second represents the sample mean. All
possible NA’s are imputed using <code><a href="https://rdrr.io/pkg/refund/man/fpca.face.html" class="external-link">refund::fpca.face()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_ccds_multiplier</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results_ccds_multiplier</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results_ccds_multiplier</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>, <span class="op">-</span><span class="fl">8</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">10</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="va">results_ccds_multiplier</span><span class="op">$</span><span class="va">time</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results_ccds_multiplier</span><span class="op">$</span><span class="va">yhat</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Seconds"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"Percent_Outcome"</span>,</span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Functional_Data_Example_files/figure-html/ccds_plot_cs_multiplier-1.png" width="576"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_ccds_multiplier_para</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results_ccds_multiplier_para</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results_ccds_multiplier_para</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2</span>, <span class="fl">2.5</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="va">results_ccds_multiplier_para</span><span class="op">$</span><span class="va">time</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results_ccds_multiplier_para</span><span class="op">$</span><span class="va">yhat</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Seconds"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"Percent_Outcome"</span>,</span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Functional_Data_Example_files/figure-html/ccds_plot_cs_multiplier_para-1.png" width="576"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_ccds_multiplier_sample</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results_ccds_multiplier_sample</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results_ccds_multiplier_sample</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>, <span class="op">-</span><span class="fl">8</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">10</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="va">results_ccds_multiplier_sample</span><span class="op">$</span><span class="va">time</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results_ccds_multiplier_sample</span><span class="op">$</span><span class="va">yhat</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Seconds"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"Percent_Outcome"</span>, </span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Functional_Data_Example_files/figure-html/ccds_plot_cs_multiplier_sample-1.png" width="576"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_ccds_multiplier_overall</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results_ccds_multiplier_overall</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results_ccds_multiplier_overall</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>, <span class="op">-</span><span class="fl">8</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">10</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="va">results_ccds_multiplier_overall</span><span class="op">$</span><span class="va">time</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results_ccds_multiplier_overall</span><span class="op">$</span><span class="va">yhat</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Seconds"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"Percent_Outcome"</span>, </span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Functional_Data_Example_files/figure-html/ccds_plot_cs_multiplier_overall-1.png" width="576"></p>
<p>To further illustrate the power of
<code><a href="../reference/SCB_functional_outcome.html">SCoRES::SCB_functional_outcome</a></code> for constructing SCBs for
multiple group variables, we load the pupil data and perform the
analysis introduced before.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pupil</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co"># filter all NA subjects</span></span>
<span><span class="va">pupil_fpca</span> <span class="op">&lt;-</span> <span class="fu">SCoRES</span><span class="fu">::</span><span class="fu"><a href="../reference/prepare_pupil_fpca.html">prepare_pupil_fpca</a></span><span class="op">(</span><span class="va">pupil</span><span class="op">)</span></span>
<span><span class="va">fosr_mod</span> <span class="op">&lt;-</span> <span class="fu">mgcv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/bam.html" class="external-link">bam</a></span><span class="op">(</span><span class="va">percent_change</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">seconds</span>, k<span class="op">=</span><span class="fl">30</span>, bs<span class="op">=</span><span class="st">"cr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">s</span><span class="op">(</span><span class="va">seconds</span>, by <span class="op">=</span> <span class="va">use</span>, k<span class="op">=</span><span class="fl">30</span>, bs <span class="op">=</span> <span class="st">"cr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">s</span><span class="op">(</span><span class="va">seconds</span>, by <span class="op">=</span> <span class="va">age</span>, k <span class="op">=</span> <span class="fl">30</span>, bs <span class="op">=</span> <span class="st">"cr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">s</span><span class="op">(</span><span class="va">seconds</span>, by <span class="op">=</span> <span class="va">gender</span>, k<span class="op">=</span><span class="fl">30</span>, bs <span class="op">=</span> <span class="st">"cr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">s</span><span class="op">(</span><span class="va">id</span>, by <span class="op">=</span> <span class="va">Phi1</span>, bs<span class="op">=</span><span class="st">"re"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">s</span><span class="op">(</span><span class="va">id</span>, by <span class="op">=</span> <span class="va">Phi2</span>, bs<span class="op">=</span><span class="st">"re"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">s</span><span class="op">(</span><span class="va">id</span>, by <span class="op">=</span> <span class="va">Phi3</span>, bs<span class="op">=</span><span class="st">"re"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">s</span><span class="op">(</span><span class="va">id</span>, by <span class="op">=</span> <span class="va">Phi4</span>, bs<span class="op">=</span><span class="st">"re"</span><span class="op">)</span>,</span>
<span>            method <span class="op">=</span> <span class="st">"fREML"</span>, data <span class="op">=</span> <span class="va">pupil_fpca</span>, discrete <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Here, we analyze the 40-years-old male user group by specifying
<code>group_name = c("use", "age", "gender")</code> and
<code>group_value = c(1, 40, 0)</code>. We set
<code>fitted = TRUE</code> and <code>est_mean= TRUE</code>.</p>
<p>The SCBs are estimated using both options separately for the mean
outcome Y(t) of the specified group:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>f</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo>=</mo><mn>40</mn><mo>,</mo><msub><mi>X</mi><mn>3</mn></msub><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>40</mn><mo>*</mo><msub><mi>β</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\hat{f}(t) = E[Y(t) | X_{1} = 1, X_{2} = 40, X_{3} = 0]= \beta_0(t) + \beta_1(t) + 40*\beta_2(t),
</annotation></semantics></math> where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y_i(t)</annotation></semantics></math>
is a functional outcome (percent_change)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_{1}</annotation></semantics></math>
is a scalar covariate (use)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_{2}</annotation></semantics></math>
is a continuous covariate (age)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>3</mn></msub><annotation encoding="application/x-tex">X_{3}</annotation></semantics></math>
is a scalar covariate (gender)</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CMA approach</span></span>
<span><span class="va">results_pupil_cma</span> <span class="op">&lt;-</span> <span class="fu">SCoRES</span><span class="fu">::</span><span class="fu"><a href="../reference/SCB_functional_outcome.html">SCB_functional_outcome</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pupil</span>,</span>
<span>                                          object <span class="op">=</span> <span class="va">fosr_mod</span>, </span>
<span>                                          method <span class="op">=</span> <span class="st">"cma"</span>, </span>
<span>                                          fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                          est_mean <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                          alpha <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>                                          outcome <span class="op">=</span> <span class="st">"percent_change"</span>, </span>
<span>                                          time <span class="op">=</span> <span class="st">"seconds"</span>, </span>
<span>                                          group_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"use"</span>, <span class="st">"age"</span>, <span class="st">"gender"</span><span class="op">)</span>, </span>
<span>                                          group_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">40</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>                                          subject <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Multiplier-t Bootstrap</span></span>
<span><span class="va">results_pupil_multiplier</span> <span class="op">&lt;-</span> <span class="fu">SCoRES</span><span class="fu">::</span><span class="fu"><a href="../reference/SCB_functional_outcome.html">SCB_functional_outcome</a></span><span class="op">(</span></span>
<span>                                          data <span class="op">=</span> <span class="va">pupil</span>, </span>
<span>                                          object <span class="op">=</span> <span class="va">fosr_mod</span>,</span>
<span>                                          fitted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                          method <span class="op">=</span> <span class="st">"multiplier"</span>, </span>
<span>                                          est_mean <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                          alpha <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>                                          outcome <span class="op">=</span> <span class="st">"percent_change"</span>, </span>
<span>                                          time <span class="op">=</span> <span class="st">"seconds"</span>, </span>
<span>                                          group_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"use"</span>, <span class="st">"age"</span>,                                           <span class="st">"gender"</span><span class="op">)</span>, </span>
<span>                                          group_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">40</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>                                          subject <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code></pre></div>
<p>The following plots show the SCBs and inverse SCBs for the mean
outcome function. The first one is from CMA approach and the second is
from multiplier bootstrap.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_pupil_cma</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results_pupil_cma</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results_pupil_cma</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="op">-</span><span class="fl">20</span>, <span class="op">-</span><span class="fl">22</span>, <span class="op">-</span><span class="fl">24</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="va">results_pupil_cma</span><span class="op">$</span><span class="va">time</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results_pupil_cma</span><span class="op">$</span><span class="va">yhat</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Seconds"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"Percent_Outcome"</span>,</span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Functional_Data_Example_files/figure-html/pupil_plot_cs_cma-1.png" width="576"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_pupil_multiplier</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results_pupil_multiplier</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results_pupil_multiplier</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="op">-</span><span class="fl">20</span>, <span class="op">-</span><span class="fl">22</span>, <span class="op">-</span><span class="fl">24</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="va">results_pupil_multiplier</span><span class="op">$</span><span class="va">time</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results_pupil_multiplier</span><span class="op">$</span><span class="va">yhat</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Seconds"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"Percent_Outcome"</span>,</span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Functional_Data_Example_files/figure-html/pupil_plot_cs_multiplier-1.png" width="576"></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
