<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Linear_Model_Example • SCoRES Package</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Linear_Model_Example">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SCoRES Package</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/SCoRES.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/Functional_Data_Example.html">Functional Data Example</a></li>
    <li><a class="dropdown-item" href="../articles/Geographic_Data_Example.html">Geographic Data Example</a></li>
    <li><a class="dropdown-item" href="../articles/Linear_Model_Example.html">Linear Model Example</a></li>
    <li><a class="dropdown-item" href="../articles/Methods.html">Methods</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AngelaYuStat/SCoRES/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Linear_Model_Example</h1>
                        <h4 data-toc-skip class="author">Angela Yu</h4>
            
            <h4 data-toc-skip class="date">2025-09-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/AngelaYuStat/SCoRES/blob/HEAD/vignettes/Linear_Model_Example.Rmd" class="external-link"><code>vignettes/Linear_Model_Example.Rmd</code></a></small>
      <div class="d-none name"><code>Linear_Model_Example.Rmd</code></div>
    </div>

    
    
<p>The example here is to use simulated data to construct the
simultaneous outer and inner confidence region from simultaneous
confidence bands (SCB) using linear regression.
<code><a href="../reference/SCB_linear_outcome.html">SCoRES::SCB_linear_outcome()</a></code> function use a non-parametric
bootstrap algorithm to construct the SCB in linear regression. The
argument <code>df_fit</code> specifies a data frame containing the
training design matrix used to fit the linear model, while
<code>grid_df</code> define the mean outcome for which simultaneous
confidence bands (SCB) are constructed. Use argument <code>model</code>
to specify the formula used for fitting the linear model.</p>
<p>In the following example, we establishes simultaneous confidence
bands for the expected response surface
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msubsup><mi>X</mi><mn>1</mn><mn>2</mn></msubsup><mo>,</mo><msubsup><mi>X</mi><mn>1</mn><mn>3</mn></msubsup><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo>,</mo><msubsup><mi>X</mi><mn>2</mn><mn>2</mn></msubsup><mo>,</mo><msubsup><mi>X</mi><mn>3</mn><mn>2</mn></msubsup><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y|X_1,X^2_1,X^3_1,X_2,X^2_2,X^2_3]</annotation></semantics></math>,
with the independent variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math>
discretized into 100 equidistant points over the domain
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>−</mi><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[-1, 1]</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://angelayustat.github.io/SCoRES">SCoRES</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">262</span><span class="op">)</span></span>
<span><span class="co"># generate simulated data</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x1</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x1</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">1.1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">^</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x2</span> <span class="op">+</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="va">x2</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">1.1</span> <span class="op">*</span> <span class="va">x2</span><span class="op">^</span><span class="fl">3</span> <span class="op">+</span> <span class="va">epsilon</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># fit the linear regression model and obtain the SCB for y</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">"y ~ x1 + I(x1^2) + I(x1^3) + x2 + I(x2^2) + I(x2^3)"</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SCB_linear_outcome.html">SCB_linear_outcome</a></span><span class="op">(</span>df_fit <span class="op">=</span> <span class="va">df</span>, model <span class="op">=</span> <span class="va">model</span>, grid_df <span class="op">=</span> <span class="va">grid</span><span class="op">)</span></span></code></pre></div>
<p>The <code>levels = c(-0.3, 0, 0.3)</code> argument specifies a set of
thresholds, and <code><a href="../reference/plot_cs.html">SCoRES::plot_cs()</a></code> function estimates
multiple inverse upper excursion sets corresponding to these thresholds,
and plot the estimated inverse region, the inner confidence region, and
the outer confidence region.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results</span><span class="op">$</span><span class="va">Mean</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"x1"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"y"</span>, </span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Linear_Model_Example_files/figure-html/simulate_plot_cs_linear-1.png" width="576"></p>
<p>In the following example, we establishes simultaneous confidence
bands for the expected response surface
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msubsup><mi>X</mi><mn>1</mn><mn>2</mn></msubsup><mo>,</mo><msubsup><mi>X</mi><mn>1</mn><mn>3</mn></msubsup><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y|X_1,X^2_1,X^3_1, X_2 =0]</annotation></semantics></math>,
with the independent variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>
discretized into 100 equidistant points over the domain
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>−</mi><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[-1, 1]</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SCB_linear_outcome.html">SCB_linear_outcome</a></span><span class="op">(</span>df_fit <span class="op">=</span> <span class="va">df</span>, model <span class="op">=</span> <span class="va">model</span>, grid_df <span class="op">=</span> <span class="va">grid</span><span class="op">)</span></span></code></pre></div>
<p>The <code>levels = c(-1.5, -1.0, -0.5)</code> argument specifies a
set of thresholds, and <code><a href="../reference/plot_cs.html">SCoRES::plot_cs()</a></code> function estimates
multiple inverse upper excursion sets corresponding to these thresholds,
and plot the estimated inverse region, the inner confidence region, and
the outer confidence region.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">1.0</span>, <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results</span><span class="op">$</span><span class="va">Mean</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"x2"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"y"</span>, </span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Linear_Model_Example_files/figure-html/simulate_plot_cs_linear_2-1.png" width="576"></p>
<p>In addition to linear regression, <code>SCoRES</code> also
provides<code><a href="../reference/SCB_logistic_outcome.html">SCoRES::SCB_logistic_outcome()</a></code> for estimating the
SCB for outcome of logistic regression. The mean outcome here for
establishing the SCB stays the same.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate simulated data</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x1</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x1</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">1.1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">^</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x2</span> <span class="op">+</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="va">x2</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">1.1</span> <span class="op">*</span> <span class="va">x2</span><span class="op">^</span><span class="fl">3</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expit.html">expit</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">100</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># fit the logistic regression model and obtain the SCB for y</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">"y ~ x1 + I(x1^2) + I(x1^3) + x2 + I(x2^2) + I(x2^3)"</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SCB_logistic_outcome.html">SCB_logistic_outcome</a></span><span class="op">(</span>df_fit <span class="op">=</span> <span class="va">df</span>, model <span class="op">=</span> <span class="va">model</span>, grid_df <span class="op">=</span> <span class="va">grid</span><span class="op">)</span></span></code></pre></div>
<p>Likewise, the <code>levels = c(0.3, 0.4, 0.5)</code> argument
specifies a set of thresholds, and <code><a href="../reference/plot_cs.html">SCoRES::plot_cs()</a></code>
function estimates multiple inverse upper excursion sets corresponding
to these thresholds, and plot the estimated inverse region, the inner
confidence region, and the outer confidence region.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results</span><span class="op">$</span><span class="va">Mean</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"x1"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"y"</span>, </span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Linear_Model_Example_files/figure-html/simulate_plot_cs_logistic-1.png" width="576"></p>
<p>In the following example, we establishes simultaneous confidence
bands for the expected response surface
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msubsup><mi>X</mi><mn>1</mn><mn>2</mn></msubsup><mo>,</mo><msubsup><mi>X</mi><mn>1</mn><mn>3</mn></msubsup><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[Y|X_1,X^2_1,X^3_1, X_2 =0]</annotation></semantics></math>,
with the independent variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>
discretized into 100 equidistant points over the domain
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>−</mi><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[-1, 1]</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SCB_logistic_outcome.html">SCB_logistic_outcome</a></span><span class="op">(</span>df_fit <span class="op">=</span> <span class="va">df</span>, model <span class="op">=</span> <span class="va">model</span>, grid_df <span class="op">=</span> <span class="va">grid</span><span class="op">)</span></span></code></pre></div>
<p>The <code>levels = c(0.3, 0.4, 0.5)</code> argument specifies a set
of thresholds, and <code><a href="../reference/plot_cs.html">SCoRES::plot_cs()</a></code> function estimates
multiple inverse upper excursion sets corresponding to these thresholds,
and plot the estimated inverse region, the inner confidence region, and
the outer confidence region.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results</span><span class="op">$</span><span class="va">Mean</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"x2"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"y"</span>, </span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Linear_Model_Example_files/figure-html/simulate_plot_cs_logistic_2-1.png" width="576"></p>
<p>Besides, <code><a href="../reference/SCB_regression_coef.html">SCoRES::SCB_regression_coef</a></code> can estimate the
SCB for every coefficient (50 in total) in the linear/logistic
model.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="co"># generate simulated data</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.4</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">M</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">M</span>, <span class="fl">1</span><span class="op">:</span><span class="va">M</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">j</span><span class="op">)</span> <span class="va">rho</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">i</span> <span class="op">-</span> <span class="va">j</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">M</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span></span>
<span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta</span> <span class="op">+</span> <span class="va">epsilon</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="co"># fit the linear regression model and obtain the SCB for all betas</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">"y ~ ."</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SCB_regression_coef.html">SCB_regression_coef</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p>Likewise, the <code>levels = c(-2, -0.5, -0.1, 0.2)</code> argument
specifies a set of thresholds, and <code><a href="../reference/plot_cs.html">SCoRES::plot_cs()</a></code>
function estimates multiple inverse upper excursion sets corresponding
to these thresholds, and plot the estimated inverse region, the inner
confidence region, and the outer confidence region.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intercept"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results</span><span class="op">$</span><span class="va">Mean</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Coefficients"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"SCBs for Coefficients"</span>, </span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Linear_Model_Example_files/figure-html/simulate_plot_cs_coef-1.png" width="576"></p>
<p>Users can also compute the SCB for any linear combination of these
coefficients by specifying a weight vector of the same length as the
coefficient vector. This can be done by using
<code><a href="../reference/SCB_regression_outcome.html">SCoRES::SCB_regression_outcome()</a></code>, and specify the linear
combination through <code>w</code>. For example, suppose we want to
calculate the SCB for the linear combination
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1+\beta_2+\beta_3</annotation></semantics></math>
for model:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><msubsup><mi>X</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><msubsup><mi>X</mi><mn>1</mn><mn>3</mn></msubsup><mo>+</mo><msub><mi>β</mi><mn>4</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mo>+</mo><msub><mi>β</mi><mn>5</mn></msub><msubsup><mi>X</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msub><mi>β</mi><mn>6</mn></msub><msubsup><mi>X</mi><mn>3</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">y=\beta_0+\beta_1 X_1 +\beta_2X^2_1+\beta_3X^3_1+\beta_4X_2+\beta_5X^2_2+\beta_6X^2_3</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x1</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x1</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">1.1</span> <span class="op">*</span> <span class="va">x1</span><span class="op">^</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x2</span> <span class="op">+</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="va">x2</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">1.1</span> <span class="op">*</span> <span class="va">x2</span><span class="op">^</span><span class="fl">3</span> <span class="op">+</span> <span class="va">epsilon</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># fit the linear regression model and obtain the SCB for y</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">"y ~ x1 + I(x1^2) + I(x1^3) + x2 + I(x2^2) + I(x2^3)"</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/SCB_regression_outcome.html">SCB_regression_outcome</a></span><span class="op">(</span>df_fit <span class="op">=</span> <span class="va">df</span>, model <span class="op">=</span> <span class="va">model</span>,</span>
<span>                       grid_df <span class="op">=</span> <span class="va">grid</span>, n_boot <span class="op">=</span> <span class="fl">50</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                       fitted <span class="op">=</span> <span class="cn">FALSE</span>, w <span class="op">=</span> <span class="va">w</span><span class="op">)</span></span>
<span><span class="co">#&gt;            scb_low      Mean   scb_up</span></span>
<span><span class="co">#&gt; scb_low -0.5933254 0.7019345 1.997194</span></span></code></pre></div>
<p>In the following example, we load <code>ipad</code> dataset, and
establishes simultaneous confidence bands for all the coefficients and
the intercept in the model fitted.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://angelayustat.github.io/SCoRES">SCoRES</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">262</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ipad</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">ipad</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">t_mmr1</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">p_fpc1</span>, <span class="va">p_fpc2</span>, <span class="va">p_fpc3</span>, <span class="va">p_fpc4</span>, <span class="va">p_fpc5</span>, <span class="va">p_fpc6</span>,</span>
<span>         <span class="va">p_PMC_pctChg</span>, <span class="va">p_auc</span>, <span class="va">t_mmr1</span>,</span>
<span>         <span class="va">i_prop_false_timeout</span>, <span class="va">i_prop_failed1</span>, <span class="va">i_prop_failed2</span>, </span>
<span>         <span class="va">i_judgement_time1</span>, <span class="va">i_judgement_time2</span>, <span class="va">i_time_outside_reticle</span>, </span>
<span>         <span class="va">i_time_on_edge</span>, <span class="va">i_prop_hit</span>, <span class="va">i_correct_reaction2</span>, </span>
<span>         <span class="va">i_reaction_time_max2</span>, <span class="va">i_reaction_time2</span>, <span class="va">i_rep_shapes12</span>, </span>
<span>         <span class="va">i_rep_shapes34</span>, <span class="va">i_memory_time12</span>, <span class="va">i_memory_time34</span>, </span>
<span>         <span class="va">i_composite_score</span>, <span class="va">h_hr</span>, <span class="va">h_dbp</span>, <span class="va">h_sbp</span>, <span class="va">recent_smoke</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>log_tmmr1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">t_mmr1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df_lin</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">recent_smoke</span>, <span class="op">-</span><span class="va">t_mmr1</span><span class="op">)</span></span>
<span><span class="co"># fit the linear regression model and obtain the SCB for y</span></span>
<span><span class="va">model_lin</span> <span class="op">&lt;-</span> <span class="st">"log_tmmr1 ~ ."</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SCB_regression_coef.html">SCB_regression_coef</a></span><span class="op">(</span>df_fit <span class="op">=</span> <span class="va">df_lin</span>, model <span class="op">=</span> <span class="va">model_lin</span><span class="op">)</span></span></code></pre></div>
<p>The <code>levels = c(0.2, 0.3, 0.4)</code> argument specifies a set
of thresholds, and <code><a href="../reference/plot_cs.html">SCoRES::plot_cs()</a></code> function estimates
multiple inverse upper excursion sets corresponding to these thresholds,
and plot the estimated inverse region, the inner confidence region, and
the outer confidence region. Here, for illustration, we filter out the
SCB for intercept.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_lin</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_lin</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results</span><span class="op">$</span><span class="va">Mean</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">""</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">""</span>, </span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Linear_Model_Example_files/figure-html/ipad_plot_cs_linear-1.png" width="576"></p>
<p>We fit a logistic model with the same equation, and obtain SCBs for
all coefficients and the intercept.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_log</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">t_mmr1</span>, <span class="op">-</span><span class="va">log_tmmr1</span><span class="op">)</span></span>
<span><span class="co"># fit the logistic regression model and obtain the SCB for y</span></span>
<span><span class="va">model_log</span> <span class="op">&lt;-</span> <span class="st">"recent_smoke ~ ."</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SCB_regression_coef.html">SCB_regression_coef</a></span><span class="op">(</span>df_fit <span class="op">=</span> <span class="va">df_log</span>, model <span class="op">=</span> <span class="va">model_log</span>, type <span class="op">=</span> <span class="st">"logistic"</span><span class="op">)</span></span></code></pre></div>
<p>The <code>levels = c(2e-07, 3e-07, 4e-07)</code> argument specifies a
set of thresholds, and <code><a href="../reference/plot_cs.html">SCoRES::plot_cs()</a></code> function estimates
multiple inverse upper excursion sets corresponding to these thresholds,
and plot the estimated inverse region, the inner confidence region, and
the outer confidence region. Here, for illustration, we filter out the
SCB for intercept.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2e-07</span>, <span class="fl">3e-07</span>, <span class="fl">4e-07</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_log</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_log</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results</span><span class="op">$</span><span class="va">Mean</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">""</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">""</span>, </span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Linear_Model_Example_files/figure-html/ipad_plot_cs_logistic-1.png" width="576"></p>
<p>In the following example, we illustrate the usge of
<code>grid_df</code> for <code>ipad</code> data.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid_lin</span> <span class="op">&lt;-</span> <span class="va">df_lin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">p_fpc1</span>, <span class="va">p_fpc2</span>, <span class="va">p_fpc3</span>, <span class="va">p_fpc4</span>, <span class="va">p_fpc5</span>, <span class="va">p_fpc6</span>, <span class="va">p_PMC_pctChg</span>, <span class="va">p_auc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">p_auc</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SCB_linear_outcome.html">SCB_linear_outcome</a></span><span class="op">(</span>df_fit <span class="op">=</span> <span class="va">df_lin</span>, model <span class="op">=</span> <span class="va">model_lin</span>, grid_df <span class="op">=</span> <span class="va">grid_lin</span><span class="op">)</span></span></code></pre></div>
<p>The <code>levels = c(-3, 0, 3)</code> argument specifies a set of
thresholds, and <code><a href="../reference/plot_cs.html">SCoRES::plot_cs()</a></code> function estimates
multiple inverse upper excursion sets corresponding to these thresholds,
and plot the estimated inverse region, the inner confidence region, and
the outer confidence region.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="va">results</span>,</span>
<span>        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>        x <span class="op">=</span> <span class="va">grid_lin</span><span class="op">$</span><span class="va">p_auc</span>, </span>
<span>        mu_hat <span class="op">=</span> <span class="va">results</span><span class="op">$</span><span class="va">Mean</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">""</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">""</span>,  </span>
<span>        level_label <span class="op">=</span> <span class="cn">T</span>, </span>
<span>        min.size <span class="op">=</span> <span class="fl">40</span>, </span>
<span>        palette <span class="op">=</span> <span class="st">"Spectral"</span>, </span>
<span>        color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="Linear_Model_Example_files/figure-html/ipad_estimate_outcome_SCI_linear_plot_cs-1.png" width="576"></p>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhuoran Yu, Armin Schwartzman, Junting Ren, Julia Wrobel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
