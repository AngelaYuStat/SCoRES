<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Geographic_Data_Example • SCoRES Package</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Geographic_Data_Example">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SCoRES Package</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/SCoRES.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/Functional_Data_Example.html">Functional Data Example</a></li>
    <li><a class="dropdown-item" href="../articles/Geographic_Data_Example.html">Geographic Data Example</a></li>
    <li><a class="dropdown-item" href="../articles/Linear_Model_Example.html">Linear Model Example</a></li>
    <li><a class="dropdown-item" href="../articles/Methods.html">Methods</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AngelaYuStat/SCoRES/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Geographic_Data_Example</h1>
                        <h4 data-toc-skip class="author">Zhuoran
(Angela) Yu</h4>
            
            <h4 data-toc-skip class="date">2025-10-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/AngelaYuStat/SCoRES/blob/HEAD/vignettes/Geographic_Data_Example.Rmd" class="external-link"><code>vignettes/Geographic_Data_Example.Rmd</code></a></small>
      <div class="d-none name"><code>Geographic_Data_Example.Rmd</code></div>
    </div>

    
    
<p>The following example is for displaying the confidence region for the
increase of the mean summer temperature (June–August) in North America
between the 20th and 21st centuries according to the specific climate
model analyzed in <span class="citation">Sommerfeld et al.
(2018)</span>.</p>
<p><code><a href="../reference/SCB_gls_geospatial.html">SCoRES::SCB_gls_geospatial()</a></code> function uses multiplier
bootstrap algorithm to construct the SCB for a specified linear
combination of coefficients across a geographical area. The argument
<code>sp_list</code> specifies a list containing the spatial coordinates
and the observations on each spot. <code>data_fit</code> specifies a
data frame containing the design matrix used to fit the spatial
generalized least squares model (notice that the intercept should also
be included inside the data frame), while <code>w</code> defines the
weights for the linear combination of coefficients on which the
simultaneous confidence bands (SCB) are constructed. Use the
<code>correlation</code> argument to specify the correlation structure
for model fitting. If the observations are grouped, a grouping factor
can be specified using the <code>group</code> argument, and a covariance
array <code>V</code> may also be provided to supply a known covariance
matrix for each spot. <code>mask</code> is an optional logical matrix
indicating spatial locations to include in the SCB, with excluded areas
(e.g., water) set to 0 or NA.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">nlme</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://angelayustat.github.io/SCoRES/">SCoRES</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">climate_data</span><span class="op">)</span></span>
<span><span class="va">start_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># construct confidence region for the increase of the mean temperature (June-August) in North America between the 20th and 21st centuries</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="../reference/SCB_gls_geospatial.html">SCB_gls_geospatial</a></span><span class="op">(</span>sp_list <span class="op">=</span> <span class="va">climate_data</span><span class="op">$</span><span class="va">Z</span>, </span>
<span>                       level <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                       data_fit <span class="op">=</span> <span class="va">climate_data</span><span class="op">$</span><span class="va">X</span>,</span>
<span>                       w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>                       correlation <span class="op">=</span> <span class="va">climate_data</span><span class="op">$</span><span class="va">correlation</span>,</span>
<span>                       mask <span class="op">=</span> <span class="va">climate_data</span><span class="op">$</span><span class="va">mask</span>, </span>
<span>                       alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">end_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">time_taken</span> <span class="op">&lt;-</span> <span class="va">end_time</span> <span class="op">-</span> <span class="va">start_time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">time_taken</span><span class="op">)</span></span>
<span><span class="co">#&gt; Time difference of 9.748226 mins</span></span></code></pre></div>
<p>Heat maps show the estimate of the mean temperature difference. The
first row displays the contours of the outer confidence regions, the
estimated inverse regions, and the inner confidence regions, for various
levels. The three plots in the second row display the simultaneous
confidence regions (SCRs) for the inverse regions, where the estimated
mean difference is greater or equal to the individual levels of 1.5,
2.0, or 2.5 respectively. In the second row, the blue line is the
contour of the outer confidence region, the green line is the contour of
the estimated inverse region and the red line is the contour of the
inner confidence region.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scb_up <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">scb_up</span>, scb_low <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">scb_low</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2</span>,<span class="fl">2.5</span>,<span class="fl">3</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">x</span>, y <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">y</span>, mu_hat <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">mu_hat</span>, xlab <span class="op">=</span> <span class="st">"Longitude"</span>, ylab <span class="op">=</span> <span class="st">"Latitude"</span>, level_label <span class="op">=</span> <span class="cn">T</span>, min.size <span class="op">=</span> <span class="fl">40</span>, palette <span class="op">=</span> <span class="st">"Spectral"</span>, color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scb_up <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">scb_up</span>, scb_low <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">scb_low</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">2</span>,<span class="fl">2.5</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">x</span>, y <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">y</span>, mu_hat <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">mu_hat</span>, xlab <span class="op">=</span> <span class="st">"Longitude"</span>, ylab <span class="op">=</span> <span class="st">"Latitude"</span>,together <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="va">p2</span><span class="op">/</span><span class="va">p1</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="Geographic_Data_Example_files/figure-html/climate_data-plot_cs-1.png" width="960"></p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-Sommerfeld:2018" class="csl-entry">
Sommerfeld, M., Sain, S., &amp; Schwartzman, A. (2018). Confidence
regions for spatial excursion sets from repeated random field
observations, with an application to climate. <em>Journal of the
American Statistical Association</em>, <em>113</em>(523), 1327–1340. <a href="https://doi.org/10.1080/01621459.2017.1341838" class="external-link">https://doi.org/10.1080/01621459.2017.1341838</a>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhuoran Yu, Armin Schwartzman, Junting Ren, Julia Wrobel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
