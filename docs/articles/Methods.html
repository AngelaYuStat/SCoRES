<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Methods â€¢ SCoRES</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Methods">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SCoRES</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/SCoRES.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Functional_Data_Example.html">Functional_Data_Example</a>
    </li>
    <li>
      <a href="../articles/Geographic_Data_Examples.html">Geographic_Data_Examples</a>
    </li>
    <li>
      <a href="../articles/Linear_Model_Example.html">Linear_Model_Example</a>
    </li>
    <li>
      <a href="../articles/Methods.html">Methods</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Methods</h1>
                        <h4 data-toc-skip class="author">Angela Yu</h4>
            
            <h4 data-toc-skip class="date">2025-07-27</h4>
      

      <div class="hidden name"><code>Methods.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="definition-of-inverse-set-and-introduction-of-the-estimating-method">Definition of Inverse Set and Introduction of the Estimating
Method<a class="anchor" aria-label="anchor" href="#definition-of-inverse-set-and-introduction-of-the-estimating-method"></a>
</h2>
<p>The identification of domain sets whose outcomes belong to predefined
subsets can address fundamental risk assessment challenges in
climatology and medicine. A motivating example involves estimating
geographical regions where average difference between summer and winter
temperatures exceed a certain benchmark, which help policymakers focus
on specific areas that are at higher risk for effects of climate
change.</p>
<p>Mathematically, the target region correspond to the inverse image of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>âŠ‚</mo><mi>â„</mi></mrow><annotation encoding="application/x-tex">U \subset  \mathbb{R}</annotation></semantics></math>
under an unknown function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¼</mi><mo>:</mo><mi>ğ’®</mi><mo>â†’</mo><mi>â„</mi></mrow><annotation encoding="application/x-tex">\mu: \mathcal{S} \to \mathbb{R}</annotation></semantics></math>,
can be defined as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Î¼</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>U</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mi>s</mi><mo>âˆˆ</mo><mi>S</mi><mo>:</mo><mi>Î¼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆˆ</mo><mi>U</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">
\mu^{-1}(U) = \{s \in S: \mu(s) \in U\}
</annotation></semantics></math> , with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>U</mi><annotation encoding="application/x-tex">U</annotation></semantics></math>
a pre-specified subset of a real line
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>â„</mi><annotation encoding="application/x-tex">\mathbb{R}</annotation></semantics></math>
(e.g.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">[</mo><mi>c</mi><mo>,</mo><mi>âˆ</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">[c, \infty)</annotation></semantics></math>).</p>
<p>A point estimator for the inverse set can be constructed as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mi>n</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>U</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\mu}_n^{-1}(U)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mi>n</mi></msub><annotation encoding="application/x-tex">\hat{\mu}_n</annotation></semantics></math>
is an empirical estimator of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¼</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
based on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
observations. To quantify the spatial uncertainty of this estimation,
Sommerfeld et al.Â (2018) introduced Coverage Probability Excursion
(CoPE) sets, defined as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">CS</mtext><mtext mathvariant="normal">in</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>U</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>âŠ†</mo><msup><mi>Î¼</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>U</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>âŠ†</mo><msub><mtext mathvariant="normal">CS</mtext><mtext mathvariant="normal">out</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>U</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\text{CS}_{\text{in}}(U) \subseteq \mu^{-1}(U) \subseteq \text{CS}_{\text{out}}(U)
</annotation></semantics></math> which satisfy:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>â„™</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">CS</mtext><mtext mathvariant="normal">in</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>U</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>âŠ†</mo><msup><mi>Î¼</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>U</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>âŠ†</mo><msub><mtext mathvariant="normal">CS</mtext><mtext mathvariant="normal">out</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>U</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>â‰¥</mo><mn>1</mn><mo>âˆ’</mo><mi>Î±</mi></mrow><annotation encoding="application/x-tex">
\mathbb{P}\left(\text{CS}_{\text{in}}(U) \subseteq \mu^{-1}(U) \subseteq \text{CS}_{\text{out}}(U)\right) \geq 1 - \alpha
</annotation></semantics></math> for a pre-specified confidence level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>âˆ’</mo><mi>Î±</mi></mrow><annotation encoding="application/x-tex">1-\alpha</annotation></semantics></math>
(e.g.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.05</annotation></semantics></math>).</p>
<p>Existing approaches require restrictive assumptions, including domain
density of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>,
continuity of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mi>n</mi></msub><annotation encoding="application/x-tex">\hat{\mu}_n</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¼</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
near thresholds, and large-sample guarantees, which limit the
applicability. Besides, the estimation and coverage depend on setting a
fixed threshold level, which is difficult to determine.</p>
<p>Ren et al.Â (2023) proposed a framework that generalizes the
estimation of such inverse sets to dense and non-dense domains with
protection against inflated Type I error, and constructs multiple upper,
lower or interval confidence sets of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Î¼</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>U</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu^{-1}(U)</annotation></semantics></math>
over arbitrary chosen thresholds. The coverage probability is achieved
non-asymptotically and simultaneously through inverting simultaneous
confidence intervals. For instance, suppose we are interested in inverse
set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Î¼</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="false" form="prefix">[</mo><mi>c</mi><mo>,</mo><mi>âˆ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\mu^{-1}([c,\infty))</annotation></semantics></math>
for a single value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>,
the inverse confidence sets (CSs) are constructed by inverting
simultaneous confidence intervals (SCIs). Given SCI bounds
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>B</mi><mo accent="true">Ì‚</mo></mover><mi>l</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ¬</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{B}_{l}(\boldsymbol{s})</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>B</mi><mo accent="true">Ì‚</mo></mover><mi>u</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ¬</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{B}_{u}(\boldsymbol{s})</annotation></semantics></math>
satisfying:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>â„™</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>âˆ€</mo><mi>ğ¬</mi><mo>âˆˆ</mo><mi>ğ’®</mi><mo>:</mo><msub><mover><mi>B</mi><mo accent="true">Ì‚</mo></mover><mi>l</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ¬</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>â‰¤</mo><mi>Î¼</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ¬</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>â‰¤</mo><msub><mover><mi>B</mi><mo accent="true">Ì‚</mo></mover><mi>u</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ¬</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>âˆ’</mo><mi>Î±</mi></mrow><annotation encoding="application/x-tex">
\mathbb{P}\left(\forall\boldsymbol{s}\in\mathcal{S}: \hat{B}_{l}(\boldsymbol{s}) \leq \mu(\boldsymbol{s}) \leq \hat{B}_{u}(\boldsymbol{s})\right) = 1-\alpha
</annotation></semantics></math></p>
<p>The inner and outer CSs for the inverse upper excursion set
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Î¼</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><mo stretchy="false" form="prefix">[</mo><mi>c</mi><mo>,</mo><mi>âˆ</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\mu^{-1}[c, \infty)</annotation></semantics></math>
are defined as:<br><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">CS</mtext><mtext mathvariant="normal">in</mtext></msub><mo stretchy="false" form="prefix">[</mo><mi>c</mi><mo>,</mo><mi>âˆ</mi><mo stretchy="false" form="postfix">)</mo><mo>:=</mo><msubsup><mover><mi>B</mi><mo accent="true">Ì‚</mo></mover><mo>â„“</mo><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">[</mo><mi>c</mi><mo>,</mo><mi>âˆ</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
\text{CS}_{\text{in}}[c, \infty) := \hat{B}_\ell^{-1}[c, \infty)
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">CS</mtext><mtext mathvariant="normal">out</mtext></msub><mo stretchy="false" form="prefix">[</mo><mi>c</mi><mo>,</mo><mi>âˆ</mi><mo stretchy="false" form="postfix">)</mo><mo>:=</mo><msubsup><mover><mi>B</mi><mo accent="true">Ì‚</mo></mover><mi>u</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">[</mo><mi>c</mi><mo>,</mo><mi>âˆ</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
\text{CS}_{\text{out}}[c,\infty) := \hat{B}_u^{-1}[c, \infty)
</annotation></semantics></math></p>
<p>The outer and inner confidence sets (CSs) for the inverse lower
excursion set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Î¼</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>âˆ’</mi><mi>âˆ</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mu^{-1}\left(-\infty, c\right]</annotation></semantics></math>
are defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">CS</mtext><mtext mathvariant="normal">in</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>âˆ’</mi><mi>âˆ</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>:=</mo><msubsup><mover><mi>B</mi><mo accent="true">Ì‚</mo></mover><mi>u</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>âˆ’</mi><mi>âˆ</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mover><mi>B</mi><mo accent="true">Ì‚</mo></mover><mi>u</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">[</mo><mi>c</mi><mo>,</mo><mi>+</mi><mi>âˆ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>âˆ</mi></msup></mrow><annotation encoding="application/x-tex">
\text{CS}_{\text{in}}\left(-\infty, c\right] := \hat{B}_u^{-1}\left(-\infty, c\right]
= \left( \hat{B}_u^{-1}\left[c, +\infty\right) \right)^{\complement}
</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">CS</mtext><mtext mathvariant="normal">out</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>âˆ’</mi><mi>âˆ</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>:=</mo><msubsup><mover><mi>B</mi><mo accent="true">Ì‚</mo></mover><mo>â„“</mo><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>âˆ’</mi><mi>âˆ</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mover><mi>B</mi><mo accent="true">Ì‚</mo></mover><mo>â„“</mo><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">[</mo><mi>c</mi><mo>,</mo><mi>+</mi><mi>âˆ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>âˆ</mi></msup></mrow><annotation encoding="application/x-tex">
\text{CS}_{\text{out}}\left(-\infty, c\right] := \hat{B}_\ell^{-1}\left(-\infty, c\right]
= \left( \hat{B}_\ell^{-1}\left[c, +\infty\right) \right)^{\complement}
</annotation></semantics></math></p>
<p>The inner and outer CSs for the inverse interval set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Î¼</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mu^{-1}[a, b]</annotation></semantics></math>
are defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">CS</mtext><mtext mathvariant="normal">in</mtext></msub><mrow><mo stretchy="true" form="prefix">[</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>:=</mo><msubsup><mover><mi>B</mi><mo accent="true">Ì‚</mo></mover><mo>â„“</mo><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">[</mo><mi>a</mi><mo>,</mo><mi>âˆ</mi><mo stretchy="false" form="postfix">)</mo><mo>âˆ©</mo><msubsup><mover><mi>B</mi><mo accent="true">Ì‚</mo></mover><mi>u</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><mi>âˆ’</mi><mi>âˆ</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
\text{CS}_{\text{in}}[a, b] := \hat{B}_\ell^{-1}[a, \infty) \cap \hat{B}_u^{-1}(-\infty, b]
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">CS</mtext><mtext mathvariant="normal">out</mtext></msub><mrow><mo stretchy="true" form="prefix">[</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>:=</mo><msubsup><mover><mi>B</mi><mo accent="true">Ì‚</mo></mover><mi>u</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">[</mo><mi>a</mi><mo>,</mo><mi>âˆ</mi><mo stretchy="false" form="postfix">)</mo><mo>âˆ©</mo><msubsup><mover><mi>B</mi><mo accent="true">Ì‚</mo></mover><mo>â„“</mo><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">(</mo><mi>âˆ’</mi><mi>âˆ</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
\text{CS}_{\text{out}}[a, b] := \hat{B}_u^{-1}[a, \infty) \cap \hat{B}_\ell^{-1}(-\infty, b]
</annotation></semantics></math> ## Linear Function-on-Scalar Regression
(FoSR)</p>
<p>A simple example for function-on-scalar regression model is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Î²</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>Î²</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>X</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>Ïµ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
Y_i(t) = \beta_0(t) + \beta_1(t) X_{i1} + b_i(t) + \epsilon_i(t),
</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y_i(t)</annotation></semantics></math>
is a functional outcome</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">X_{i1}</annotation></semantics></math>
is a scalar covariate</li>
<li>Each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î²</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta_j(t)</annotation></semantics></math>
is a coefficient function<br>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">b_i(t)</annotation></semantics></math>
is a subject-specific functional random effect. This captures
correlation within subjects over time that is not captured by the mean.
This term is not always included in FoSR models, but itâ€™s generally a
good idea because it gives better inference<br>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ïµ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\epsilon_i(t)</annotation></semantics></math>
are normally distributed iid errors</li>
</ul>
<p>Here, the same bases are used for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î²</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta_1(t)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î²</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta_2(t)</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="accounting-for-error-correlation">Accounting for Error Correlation<a class="anchor" aria-label="anchor" href="#accounting-for-error-correlation"></a>
</h3>
<p>The fitted GAM model above didnâ€™t take the correlation of residuals
into account. Here, we combined random effects and FPCA into the GAM
model to resolve this.</p>
<div class="section level4">
<h4 id="modeling-residuals-with-fpca-and-gam">Modeling residuals with FPCA and gam<a class="anchor" aria-label="anchor" href="#modeling-residuals-with-fpca-and-gam"></a>
</h4>
<p>First, fit the mean model:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Î²</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>Î²</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>X</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>e</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
Y_i(t) = \beta_0(t) + \beta_1(t) X_{i1} + e_i(t),
</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="estimate-the-fpca-for-gamm-fpca-model">Estimate the FPCA for GAMM FPCA model<a class="anchor" aria-label="anchor" href="#estimate-the-fpca-for-gamm-fpca-model"></a>
</h4>
<p>After obtaining residuals from the mean model, FPCA models the
residuals using equation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>b</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>Ïµ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">e_i(s) = b_i(s) + \epsilon_i(s)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">b_i(s)</annotation></semantics></math>
follows a mean zero Gaussian Process (GP) with covariance function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ïµ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\epsilon_i(s)</annotation></semantics></math>
are independent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>Ïƒ</mi><mi>e</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(0, \sigma_e^2)</annotation></semantics></math>
random errors.</p>
<p>Assuming that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ï•</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>â‹…</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\phi_k(\cdot)</annotation></semantics></math>
are the eigenfunctions of the covariance operator
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>X</mi></msub><annotation encoding="application/x-tex">K_X</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>â‹…</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">b_i(\cdot)</annotation></semantics></math>,
one can express:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mo accent="false">âˆ</mo></munderover><msub><mi>Î¾</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msub><mi>Ï•</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
b_i(t) = \sum_{k=1}^{\infty} \xi_{ik} \phi_k(t)
</annotation></semantics></math></p>
<p>The GAMM-FPCA model will be :</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Î²</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>Î²</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>X</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>+</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>Î¾</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msub><mi>Ï•</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>Ïµ</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
Y_i(t) = \beta_0(t) + \beta_1(t) X_{i1} + \sum_{k=1}^{K} \xi_{ik} \phi_k(t) + \epsilon_i(t),
</annotation></semantics></math></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="construction-of-simultaneous-confidence-bands-for-functional-regression-model">Construction of Simultaneous Confidence Bands for Functional
Regression Model<a class="anchor" aria-label="anchor" href="#construction-of-simultaneous-confidence-bands-for-functional-regression-model"></a>
</h2>
<div class="section level3">
<h3 id="correlation-and-multiplicity-adjusted-cma-confidence-bands-based-on-parameter-simulations">Correlation and Multiplicity Adjusted (CMA) Confidence Bands Based
on Parameter Simulations<a class="anchor" aria-label="anchor" href="#correlation-and-multiplicity-adjusted-cma-confidence-bands-based-on-parameter-simulations"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Simulate model parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ›ƒ</mi><mn>1</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>ğ›ƒ</mi><mi>B</mi></msub><mover><mo>âˆ¼</mo><mtext mathvariant="normal">i.i.d.</mtext></mover><mi>ğ’©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mo>,</mo><msub><mover><mi>V</mi><mo accent="true">Ì‚</mo></mover><mi>ğ›ƒ</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\beta}_1, \ldots, \boldsymbol{\beta}_B \overset{\text{i.i.d.}}{\sim} \mathcal{N}(\hat{\boldsymbol{\beta}}, \hat{V}_{\boldsymbol{\beta}})</annotation></semantics></math>
, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>ğ›ƒ</mi><mo accent="true">Ì‚</mo></mover><mo>,</mo><msub><mover><mi>V</mi><mo accent="true">Ì‚</mo></mover><mi>ğ›ƒ</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\hat{\boldsymbol{\beta}}, \hat{V}_{\boldsymbol{\beta}})</annotation></semantics></math>
are estimated via a fitted FoSR model.</p></li>
<li><p>For each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">b = 1, \ldots, B</annotation></semantics></math>,
compute
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ—</mi><mi>b</mi></msub><mo>=</mo><mfrac><mrow><mi>ğ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mi>b</mi></msub><mo>âˆ’</mo><mover><mi>Î²</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msub><mi>ğƒ</mi><mi>f</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">
\mathbf{X}_b = \frac{\mathbf{B}({\beta}_b - \hat{{\beta}})}{\mathbf{D}_f}
</annotation></semantics></math> , where the division is element-wise
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ</mi><annotation encoding="application/x-tex">\mathbf{B}</annotation></semantics></math>
maps parameters to functional effects.</p></li>
<li><p>Let
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>b</mi></msub><mo>=</mo><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>ğ—</mi><mi>b</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mi>b</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">
d_b = \max(|\mathbf{X}_b|), \quad b = 1, \ldots, B
</annotation></semantics></math> , where the absolute value is taken
element-wise.</p></li>
<li><p>Estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>C</mi><mi>f</mi></msub><mo>,</mo><mn>1</mn><mo>âˆ’</mo><mi>Î±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">q(C_f, 1 - \alpha)</annotation></semantics></math>
as the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mo>â‹…</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><mi>Î±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">100 \cdot (1 - \alpha)</annotation></semantics></math>
percentile of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>d</mi><mn>1</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{d_1, \ldots, d_B\}</annotation></semantics></math>.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="multiplier-t-bootstrap-procedure-for-constructing-confidence-bands">Multiplier-t Bootstrap Procedure for Constructing Confidence
Bands<a class="anchor" aria-label="anchor" href="#multiplier-t-bootstrap-procedure-for-constructing-confidence-bands"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Compute residuals
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>R</mi><mn>1</mn><mi>N</mi></msubsup><mo>,</mo><mi>â€¦</mi><mo>,</mo><msubsup><mi>R</mi><mi>N</mi><mi>N</mi></msubsup></mrow><annotation encoding="application/x-tex">R_1^N, \ldots, R_N^N</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>R</mi><mi>n</mi><mi>N</mi></msubsup><mo>=</mo><msqrt><mfrac><mi>N</mi><mrow><mi>N</mi><mo>âˆ’</mo><mn>1</mn></mrow></mfrac></msqrt><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>âˆ’</mo><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mi>N</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">R_n^N = \sqrt{\frac{N}{N - 1}} \left( Y_n - \hat{\mu}_N \right)</annotation></semantics></math>,
and multipliers
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mn>1</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>g</mi><mi>N</mi></msub><mover><mo>âˆ¼</mo><mtext mathvariant="normal">i.i.d.</mtext></mover><mi>g</mi></mrow><annotation encoding="application/x-tex">g_1, \ldots, g_N \overset{\text{i.i.d.}}{\sim} g</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ”¼</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>g</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mathbb{E}[g] = 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">[</mo><mi>g</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\mathrm{var}[g] = 1</annotation></semantics></math>.</p></li>
<li><p>Estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>Ïµ</mi><mo accent="true">Ì‚</mo></mover><mi>N</mi><mo>*</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\epsilon}_N^*(s)</annotation></semantics></math>
from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mn>1</mn></msub><msub><mi>Y</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>g</mi><mi>N</mi></msub><msub><mi>Y</mi><mi>N</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_1 Y_1(s), \ldots, g_N Y_N(s)</annotation></semantics></math>.</p></li>
<li><p>Compute
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msqrt><mi>N</mi></msqrt></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>g</mi><mi>n</mi></msub><mfrac><mrow><msubsup><mi>R</mi><mi>n</mi><mi>N</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msubsup><mover><mi>Ïµ</mi><mo accent="true">Ì‚</mo></mover><mi>N</mi><mo>*</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">
T^*(s) = \frac{1}{\sqrt{N}} \sum_{n=1}^N g_n \frac{R_n^N(s)}{\hat{\epsilon}_N^*(s)}
</annotation></semantics></math></p></li>
<li><p>Repeat steps 1 to 3 many times. Take the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><mi>Î±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>â‹…</mo><mn>100</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">(1 - \alpha) \cdot 100\%</annotation></semantics></math>
quantile of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>â„’</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\mathcal{L}^*</annotation></semantics></math>
to estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>q</mi><mrow><mi>Î±</mi><mo>,</mo><mi>N</mi></mrow></msub><annotation encoding="application/x-tex">q_{\alpha, N}</annotation></semantics></math>.</p></li>
</ol>
<p>For details of the algorithm, please refer to Telschow et
al.Â (2019)</p>
<p><code>SCoRES</code> provides two options for estimating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mi>N</mi></msub><annotation encoding="application/x-tex">\hat{\mu}_N</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>R</mi><mi>n</mi><mi>N</mi></msubsup><annotation encoding="application/x-tex">R_n^N</annotation></semantics></math>.
If <code>est_mean = TRUE</code>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mi>N</mi></msub><annotation encoding="application/x-tex">\hat{\mu}_N</annotation></semantics></math>
will be estimated though using the fitted regression object. If
<code>est_mean = FALSE</code>, sample mean will be calculated. Default
is <code>FALSE</code>.</p>
<ol style="list-style-type: decimal">
<li><p>The <strong>sample mean</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mi>N</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\hat{\mu}_N(s) = \frac{1}{N} \sum_{i=1}^N {Y}_i(s)
</annotation></semantics></math> , where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">{Y}_i(s)</annotation></semantics></math>
is the observed functional response.</p></li>
<li><p>The <strong>fitted mean value</strong> from a functional
regression model (e.g., using <code><a href="https://rdrr.io/pkg/mgcv/man/bam.html" class="external-link">mgcv::bam</a></code>).</p></li>
</ol>
<p>In the multiplier bootstrap procedure, <code>SCoRES</code> supports
three types of multiplier distributions, which is specified by
<code>weights</code>:</p>
<ul>
<li>
<code>"rademacher"</code>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mi>âˆ’</mi><mn>1</mn><mo>,</mo><mi>+</mi><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">g_i \in \{-1, +1\}</annotation></semantics></math>
with equal probability</li>
<li>
<code>"gaussian"</code>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub><mo>âˆ¼</mo><mi>ğ’©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g_i \sim \mathcal{N}(0, 1)</annotation></semantics></math>
</li>
<li>
<code>"mammen"</code>: A two-point distribution with mean zero and
variance one (see Mammen, 1993)</li>
</ul>
<p>Default is <code>rademacher</code>.</p>
<p>Two options are available for estimating the standard error
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>Ïµ</mi><mo accent="true">Ì‚</mo></mover><mi>N</mi><mo>*</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\epsilon}_N^*(s_j)</annotation></semantics></math>,
which is specified by <code>method_SD</code>:</p>
<ul>
<li><p>â€œregularâ€ (empirical standard error based on residuals):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>Ïµ</mi><mo accent="true">Ì‚</mo></mover><mi>N</mi><mo>*</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msqrt><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mover><mi>Î²</mi><mo accent="true">Ì‚</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mrow><annotation encoding="application/x-tex">
\hat{\epsilon}_N^*(s_j) = \sqrt{ \frac{1}{n} \sum_{i=1}^n \left( {Y}_i(s_j) - \hat{\beta}(s_j) \right)^2 / (n-1) }
</annotation></semantics></math>.</p></li>
<li><p>â€œtâ€ (bootstrap second moment-based estimator):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>Ïµ</mi><mo accent="true">Ì‚</mo></mover><mi>N</mi><mo>*</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msqrt><mrow><mfrac><mi>N</mi><mrow><mi>N</mi><mo>âˆ’</mo><mn>1</mn></mrow></mfrac><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>ğ”¼</mi><mi>b</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>Y</mi><mi>b</mi></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo>âˆ’</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ”¼</mi><mi>b</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>Y</mi><mi>b</mi></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">|</mo></mrow></mrow></msqrt></mrow><annotation encoding="application/x-tex">
\hat{\epsilon}_N^*(s_j) = \sqrt{ \frac{N}{N-1} \left| \mathbb{E}_b\left[ {Y}^{b}(s_j)^2 \right] - \left( \mathbb{E}_b\left[ {Y}^{b}(s_j) \right] \right)^2 \right| }
</annotation></semantics></math> , where expectations are taken over
bootstrap replicates and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Y</mi><mi>b</mi></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">{Y}^{b}(s_j)</annotation></semantics></math>
is the perturbed sample in bootstrap iteration
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>.
The absolute value ensures numerical stability when subtracting large,
nearly equal quantities.</p></li>
</ul>
<p>Default is <code>t</code>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
