<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Geographic_Data_Examples • SCoRES</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Geographic_Data_Examples">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SCoRES</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/SCoRES.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Functional_Data_Example.html">Functional_Data_Example</a>
    </li>
    <li>
      <a href="../articles/Geographic_Data_Examples.html">Geographic_Data_Examples</a>
    </li>
    <li>
      <a href="../articles/Linear_Model_Example.html">Linear_Model_Example</a>
    </li>
    <li>
      <a href="../articles/Methods.html">Methods</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Geographic_Data_Examples</h1>
                        <h4 data-toc-skip class="author">Angela Yu</h4>
            
            <h4 data-toc-skip class="date">2025-07-27</h4>
      

      <div class="hidden name"><code>Geographic_Data_Examples.Rmd</code></div>

    </div>

    
    
<p>The following example is for displaying the Confidence sets for the
increase of the mean summer temperature (June–August) in North America
between the 20th and 21st centuries according to the specific climate
model analyzed in Sommerfeld et al.(2018).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">nlme</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SCoRES</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">climate_data</span><span class="op">)</span></span>
<span><span class="va">start_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># construct confidence sets for the increase of the mean temperature (June-August) in North America between the 20th and 21st centuries</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="../reference/SCB_gls_climate.html">SCB_gls_climate</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="va">climate_data</span><span class="op">$</span><span class="va">Z</span>, </span>
<span>                       level <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                       X <span class="op">=</span> <span class="va">climate_data</span><span class="op">$</span><span class="va">X</span>,</span>
<span>                       w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, </span>
<span>                       correlation <span class="op">=</span> <span class="va">climate_data</span><span class="op">$</span><span class="va">correlation</span>,</span>
<span>                       mask <span class="op">=</span> <span class="va">climate_data</span><span class="op">$</span><span class="va">mask</span>, </span>
<span>                       alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">end_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">time_taken</span> <span class="op">&lt;-</span> <span class="va">end_time</span> <span class="op">-</span> <span class="va">start_time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">time_taken</span><span class="op">)</span></span>
<span><span class="co">#&gt; Time difference of 8.686077 mins</span></span></code></pre></div>
<p>Heat maps show the estimate of the mean temperature difference. The
first row displays the contours of the outer confidence sets, estimated
inverse set, and the inner confidence sets, for various levels. The
three plots in the second row display the confidence sets for the
inverse sets, where the estimated mean difference is greater or equal to
the individual level 1.5, 2.0, or 2.5 respectively. In the second row,
the blue line is the contour of the outer confidence set, the green line
is the contour of the estimated inverse set and the red line is the
contour of the inner confidence set.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scb_up <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">scb_up</span><span class="op">[</span><span class="fl">17</span><span class="op">:</span><span class="fl">215</span>,<span class="fl">22</span><span class="op">:</span><span class="fl">110</span><span class="op">]</span>, scb_low <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">scb_low</span><span class="op">[</span><span class="fl">17</span><span class="op">:</span><span class="fl">215</span>,<span class="fl">22</span><span class="op">:</span><span class="fl">110</span><span class="op">]</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2</span>,<span class="fl">2.5</span>,<span class="fl">3</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">17</span><span class="op">:</span><span class="fl">215</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">22</span><span class="op">:</span><span class="fl">110</span><span class="op">]</span>, mu_hat <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">mu_hat</span><span class="op">[</span><span class="fl">17</span><span class="op">:</span><span class="fl">215</span>,<span class="fl">22</span><span class="op">:</span><span class="fl">110</span><span class="op">]</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, level_label <span class="op">=</span> <span class="cn">T</span>, min.size <span class="op">=</span> <span class="fl">40</span>, palette <span class="op">=</span> <span class="st">"Spectral"</span>, color_level_label <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_cs.html">plot_cs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scb_up <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">scb_up</span><span class="op">[</span><span class="fl">17</span><span class="op">:</span><span class="fl">215</span>,<span class="fl">22</span><span class="op">:</span><span class="fl">110</span><span class="op">]</span>, scb_low <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">scb_low</span><span class="op">[</span><span class="fl">17</span><span class="op">:</span><span class="fl">215</span>,<span class="fl">22</span><span class="op">:</span><span class="fl">110</span><span class="op">]</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">2</span>,<span class="fl">2.5</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">17</span><span class="op">:</span><span class="fl">215</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">22</span><span class="op">:</span><span class="fl">110</span><span class="op">]</span>, mu_hat <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">mu_hat</span><span class="op">[</span><span class="fl">17</span><span class="op">:</span><span class="fl">215</span>,<span class="fl">22</span><span class="op">:</span><span class="fl">110</span><span class="op">]</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>,together <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="va">p2</span><span class="op">/</span><span class="va">p1</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="Geographic_Data_Examples_files/figure-html/climate_data-plot_cs-1.png" width="960"></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
