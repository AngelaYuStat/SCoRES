% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scb_to_cs.R
\name{scb_to_cs}
\alias{scb_to_cs}
\title{Construct Inverse Confidence Sets from Simultaneous Confidence Bands}
\usage{
scb_to_cs(
  scb_up,
  scb_low,
  levels,
  true_mean = NULL,
  est_mean = NULL,
  x1,
  x2,
  type = "upper",
  return_contain_only = F,
  return_plot = F,
  ...
)
}
\arguments{
\item{scb_up}{A matrix or array containing the upper simultaneous confidence interval.
Must have the same dimensions as defined by the grid from \code{x1} and \code{x2}.}

\item{scb_low}{A matrix or array containing the lower bounds of the simultaneous confidence bands.
Must have the same dimensions as defined by the grid from \code{x1} and \code{x2}.}

\item{levels}{A list of scalers for different levels or matrix containing interval sets to construct the confidence sets.}

\item{true_mean}{Optional matrix of the true mean function (for simulation study or evaluation purposes).
Should have the same dimension as \code{scb_up}.}

\item{est_mean}{Optional matrix of the estimated mean function, used for plotting if \code{true_mean} is not available.
Should have the same dimension as \code{scb_up}.}

\item{x1}{A numeric vector of coordinates for the first dimension (e.g., time or x-axis).}

\item{x2}{A numeric vector of coordinates for the second dimension (e.g., space or y-axis).}

\item{type}{A character string specifying the type of inverse set to construct if levels are not a matrix.
Choices are \code{"upper"}, \code{"lower"}, or \code{"two-sided"}.}

\item{return_contain_only}{Logical. If \code{TRUE}, only return a matrix/logical map indicating whether the level set is contained.}

\item{return_plot}{Logical. If \code{TRUE}, return a ggplot object for visualization.}

\item{...}{Additional plotting parameters passed internally (e.g., to \verb{geom_*}, \code{theme}, or other components).}
}
\value{
A list containing the following components:
\describe{
\item{levels}{A vector (or matrix) of threshold levels used to define the confidence sets.}
\item{U_in}{(Optional) A list of logical matrices indicating whether each point is within the conservative inner confidence set for each level. Returned only when \code{return_contain_only = FALSE} and \code{type != "two-sided"}.}
\item{U_out}{(Optional) A list of logical matrices indicating whether each point is within the liberal outer confidence set for each level. Returned only when \code{return_contain_only = FALSE} and \code{type != "two-sided"}.}
\item{L_out}{(Two-sided only) A list of logical matrices indicating lower bound containment (for \code{type = "two-sided"}).}
\item{U_out}{(Two-sided only) A list of logical matrices indicating upper bound containment (for \code{type = "two-sided"}).}
\item{contain_individual}{A logical vector indicating whether the true mean is fully contained within each level's confidence set. Returned only if \code{true_mean} is provided.}
\item{contain_all}{A single logical value indicating whether the true mean is contained in all levels' confidence sets.}
\item{plot_cs}{(Optional) A list of ggplot2 objects for visualizing the confidence sets, returned when \code{return_plot = TRUE}. Includes both a combined plot and individual plots per level.}
}
}
\description{
This function constructs inverse confidence sets (CS) from simultaneous confidence bands (SCB),
allowing visualization and containment check of level sets of true or estimated functions.
}
\examples{
set.seed(262)
x1 <- rnorm(100)
x2 <- rnorm(100)
y <- -1 + x1 + 0.5 * x1^2 - 1.1 * x1^3 - 0.5 * x2 + 0.8 * x2^2 - 1.1 * x2^3 - rnorm(100,0,sqrt(2))
df <- data.frame(x1 = x1, x2 = x2, y = y)
grid <- data.frame(x1 = seq(-1, 1, length.out = 100), x2 = seq(-1, 1, length.out = 100))
model <- "y ~ x1 + I(x1^2) + I(x1^3) + x2 + I(x2^2) + I(x2^3)"
result <- SCB_linear_outcome(df_fit = df, model = model, grid_df = grid)
scb_to_cs(result$UpperBound, result$LowerBound, c(-1, -0.5, 0.5, 1),
x1 = grid$x1, x2 = grid$x2, est_mean = results$Mean)

}
